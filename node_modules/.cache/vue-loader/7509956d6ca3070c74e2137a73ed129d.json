{"remainingRequest":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/src/views/reportData/reportPayBehav/reportPayBehav.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/src/views/reportData/reportPayBehav/reportPayBehav.vue","mtime":1585732616766},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {queryPaymentBehavior} from '@/api/index';\nimport {weekChange} from '@/libs/changeWeek';\nimport vTitleHead from '../../game/template/TitleHead';\n\nexport default {\n    name: \"reportPayBehav\",\n    components: {vTitleHead},\n    data() {\n        return {\n            isLoading:true,\n            payHevChart: '付费行为汇总',\n            payHevChartLine: '人均付费',\n            payHevTableMoney: '付费额（元）',\n            payHevTablePeople: '付费人数',\n            isShowCondition: false,\n            defaultData: {\n                yestoday: 1,\n                week: 7,\n                month: 30\n            },\n            data: \"7\",\n            payBehavs: [],\n            payBehavesChart: [],\n            charts: [],\n            columnsPay: [\n                {\n                    title: '日期（星期）',\n                    key: 'ds',\n                    width: 150,\n                    align: 'center',\n                    fixed: 'left'\n                },\n                {\n                    title: '[0,10}',\n                    key: 'one',\n                    align: 'center',\n                    width: 150\n                },\n                {\n                    title: '(10,50]',\n                    key: 'two',\n                    align: 'center',\n                    width: 150\n                },\n                {\n                    title: '(50,100]',\n                    key: 'three',\n                    align: 'center',\n                    width: 150\n                },\n                {\n                    title: '(100,200]',\n                    key: 'foure',\n                    align: 'center',\n                    width: 150\n                },\n                {\n                    title: '(200,500]',\n                    key: 'five',\n                    align: 'center',\n                    width: 150\n                },\n                {\n                    title: '(500,1000]',\n                    key: 'six',\n                    align: 'center',\n                    width: 150\n                },\n                {\n                    title: '1000以上',\n                    key: 'seven',\n                    // width: 150\n                }\n            ],\n            columnsPayPeople: [\n                {\n                    title: '日期（星期）',\n                    key: 'ds',\n                    width: 150,\n                    align: 'center',\n                    fixed: 'left'\n                },\n                {\n                    title: '[0,10}',\n                    key: 'onePeople',\n                    align: 'center',\n                    width: 150\n                },\n                {\n                    title: '(10,50]',\n                    key: 'twoPeople',\n                    align: 'center',\n                    width: 150\n                },\n                {\n                    title: '(50,100]',\n                    key: 'threePeople',\n                    align: 'center',\n                    width: 150\n                },\n                {\n                    title: '(100,200]',\n                    key: 'fourePeople',\n                    align: 'center',\n                    width: 150\n                },\n                {\n                    title: '(200,500]',\n                    key: 'fivePeople',\n                    align: 'center',\n                    width: 150\n                },\n                {\n                    title: '(500,1000]',\n                    key: 'sixPeople',\n                    align: 'center',\n                    width: 150\n                },\n                {\n                    title: '1000以上',\n                    key: 'sevenPeople',\n                    // width: 150\n                }\n            ],\n            pyaGroupChart: {},\n            surveyOneLine: {},\n        }\n    },\n    methods: {\n        enter() {\n            this.isShowCondition = true;\n        },\n        leave() {\n            this.isShowCondition = false;\n        },\n        init() {\n            this.isLoading = true;\n            this.queryPay();\n        },\n        queryPay() {\n            let params = {\n                gameid: parseInt(this.getStore('gameid')),\n                date: parseInt(this.data)\n            };\n            queryPaymentBehavior(params).then(e => {\n                this.isLoading = false;\n                if (e.success) {\n                    let shareDailyResultTypes = e.shareDailyResultTypes;\n                    let payBehav = e.payBehavMap;\n\n                    let payBehavs = [];\n                    let numberMap = new Map();\n                    for (let key in payBehav) {\n                        //每天总付费次数\n                        let i = 0;\n                        for (let keys in payBehav[key]) {\n                            i += payBehav[key][keys].length;\n                        }\n                        numberMap.set(key, i);\n\n                        let payBehavObject = new Object();\n                        payBehavObject.ds = weekChange(key);\n\n                        let sunMoneyOne = 0,\n                            sunMoneyTwo = 0,\n                            sunMoneyThree = 0,\n                            sunMoneyFoure = 0,\n                            sunMoneyFive = 0,\n                            sunMoneySix = 0,\n                            sunMoneySeven = 0;\n                        let peopleSetOne = new Set(),\n                            peopleSetTwo = new Set(),\n                            peopleSetThree = new Set(),\n                            peopleSetFoure = new Set(),\n                            peopleSetFive = new Set(),\n                            peopleSetSix = new Set(),\n                            peopleSetSeven = new Set();\n\n                        payBehav[key].collectOne.forEach(item => {\n                            sunMoneyOne += item.amount;\n                            peopleSetOne.add(item.userid);\n                        })\n                        let sumPeopleOne = peopleSetOne.size;\n                        payBehavObject.one = sunMoneyOne / this.getStore(\"currencyRate\");\n                        payBehavObject.onePeople = sumPeopleOne;\n\n                        payBehav[key].collectTwo.forEach(item => {\n                            sunMoneyTwo += item.amount;\n                            peopleSetTwo.add(item.userid);\n                        })\n                        let sumPeopleTwo = peopleSetTwo.size;\n                        payBehavObject.two = sunMoneyTwo / this.getStore(\"currencyRate\");\n                        payBehavObject.twoPeople = sumPeopleTwo;\n\n                        payBehav[key].collectThree.forEach(item => {\n                            sunMoneyThree += item.amount;\n                            peopleSetThree.add(item.userid);\n                        })\n                        let sumPeopleThree = peopleSetThree.size;\n                        payBehavObject.three = sunMoneyThree / this.getStore(\"currencyRate\");\n                        payBehavObject.threePeople = sumPeopleThree;\n\n                        payBehav[key].collectFoure.forEach(item => {\n                            sunMoneyFoure += item.amount;\n                            peopleSetFoure.add(item.userid);\n                        })\n                        let sumPeopleFoure = peopleSetFoure.size;\n                        payBehavObject.foure = sunMoneyFoure / this.getStore(\"currencyRate\");\n                        payBehavObject.fourePeople = sumPeopleFoure;\n\n                        payBehav[key].collectFive.forEach(item => {\n                            sunMoneyFive += item.amount;\n                            peopleSetFive.add(item.userid);\n                        })\n                        let sumPeopleFive = peopleSetFive.size;\n                        payBehavObject.five = sunMoneyFive / this.getStore(\"currencyRate\");\n                        payBehavObject.fivePeople = sumPeopleFive;\n\n                        payBehav[key].collectSix.forEach(item => {\n                            sunMoneySix += item.amount;\n                            peopleSetSix.add(item.userid);\n                        })\n                        let sumPeopleSix = peopleSetSix.size;\n                        payBehavObject.six = sunMoneySix / this.getStore(\"currencyRate\");\n                        payBehavObject.sixPeople = sumPeopleSix;\n\n                        payBehav[key].collectSeven.forEach(item => {\n                            sunMoneySeven += item.amount;\n                            peopleSetSeven.add(item.userid);\n                        })\n                        let sumPeopleSeven = peopleSetSeven.size;\n                        payBehavObject.seven = sunMoneySeven / this.getStore(\"currencyRate\");\n                        payBehavObject.sevenPeople = sumPeopleSeven;\n\n                        payBehavs.push(payBehavObject);\n                    }\n\n                    //折线图\n                    let charts = [];\n                    shareDailyResultTypes.sort(this.compareR);\n                    shareDailyResultTypes.forEach(item => {\n                        let i = item.dauNum == 0 ? 0 : ((numberMap.get(item.ds) || 0) / item.dauNum).toFixed(3);\n                        let chartObject = new Object();\n                        chartObject.ds = item.ds.substr(5, 5);\n                        chartObject.value = i;\n                        charts.push(chartObject);\n                    })\n\n                    payBehavs.sort(this.compare);\n\n                    //付费行为汇总--分组柱状图\n                    let payBehavTotalOne = 0,\n                        payBehavTotalOneP = 0,\n                        payBehavTotalTwo = 0,\n                        payBehavTotalTwoP = 0,\n                        payBehavTotalThree = 0,\n                        payBehavTotalThreeP = 0,\n                        payBehavTotalFoure = 0,\n                        payBehavTotalFoureP = 0,\n                        payBehavTotalFive = 0,\n                        payBehavTotalFiveP = 0,\n                        payBehavTotalSix = 0,\n                        payBehavTotalSixP = 0,\n                        payBehavTotalSeven = 0,\n                        payBehavTotalSevenP = 0;\n\n                    payBehavs.forEach(item => {\n                        payBehavTotalOne += item.one;\n                        payBehavTotalOneP += item.onePeople;\n                        payBehavTotalTwo += item.two;\n                        payBehavTotalTwoP += item.twoPeople;\n                        payBehavTotalThree += item.three;\n                        payBehavTotalThreeP += item.threePeople;\n                        payBehavTotalFoure += item.foure;\n                        payBehavTotalFoureP += item.fourePeople;\n                        payBehavTotalFive += item.five;\n                        payBehavTotalFiveP += item.fivePeople;\n                        payBehavTotalSix += item.six;\n                        payBehavTotalSixP += item.sixPeople;\n                        payBehavTotalSeven += item.seven;\n                        payBehavTotalSevenP += item.sevenPeople;\n                    })\n\n                    let payBehavesChart = [];\n\n                    let payBehavTotalOneObjectChart = new Object();\n                    payBehavTotalOneObjectChart.name = '付费额';\n                    payBehavTotalOneObjectChart.payNum = '[0,10]';\n                    payBehavTotalOneObjectChart.value = payBehavTotalOne;\n                    payBehavesChart.push(payBehavTotalOneObjectChart);\n\n                    let payBehavTotalOnePObjectChart = new Object();\n                    payBehavTotalOnePObjectChart.name = '付费人数';\n                    payBehavTotalOnePObjectChart.payNum = '[0,10]';\n                    payBehavTotalOnePObjectChart.value = payBehavTotalOneP;\n                    payBehavesChart.push(payBehavTotalOnePObjectChart);\n\n                    let payBehavTotalTwoObjectChart = new Object();\n                    payBehavTotalTwoObjectChart.name = '付费额';\n                    payBehavTotalTwoObjectChart.payNum = '(10,50]';\n                    payBehavTotalTwoObjectChart.value = payBehavTotalTwo;\n                    payBehavesChart.push(payBehavTotalTwoObjectChart);\n\n                    let payBehavTotalTwoPObjectChart = new Object();\n                    payBehavTotalTwoPObjectChart.name = '付费人数';\n                    payBehavTotalTwoPObjectChart.payNum = '(10,50]';\n                    payBehavTotalTwoPObjectChart.value = payBehavTotalTwoP;\n                    payBehavesChart.push(payBehavTotalTwoPObjectChart);\n\n                    let payBehavTotalThreeObjectChart = new Object();\n                    payBehavTotalThreeObjectChart.name = '付费额';\n                    payBehavTotalThreeObjectChart.payNum = '(50,100]';\n                    payBehavTotalThreeObjectChart.value = payBehavTotalThree;\n                    payBehavesChart.push(payBehavTotalThreeObjectChart);\n\n                    let payBehavTotalThreePObjectChart = new Object();\n                    payBehavTotalThreePObjectChart.name = '付费人数';\n                    payBehavTotalThreePObjectChart.payNum = '(50,100]';\n                    payBehavTotalThreePObjectChart.value = payBehavTotalThreeP;\n                    payBehavesChart.push(payBehavTotalThreePObjectChart);\n\n                    let payBehavTotalFoureObjectChart = new Object();\n                    payBehavTotalFoureObjectChart.name = '付费额';\n                    payBehavTotalFoureObjectChart.payNum = '(100,200]';\n                    payBehavTotalFoureObjectChart.value = payBehavTotalFoure;\n                    payBehavesChart.push(payBehavTotalFoureObjectChart);\n\n                    let payBehavTotalFourePObjectChart = new Object();\n                    payBehavTotalFourePObjectChart.name = '付费人数';\n                    payBehavTotalFourePObjectChart.payNum = '(100,200]';\n                    payBehavTotalFourePObjectChart.value = payBehavTotalFoureP;\n                    payBehavesChart.push(payBehavTotalFourePObjectChart);\n\n                    let payBehavTotalFiveObjectChart = new Object();\n                    payBehavTotalFiveObjectChart.name = '付费额';\n                    payBehavTotalFiveObjectChart.payNum = '(200,500]';\n                    payBehavTotalFiveObjectChart.value = payBehavTotalFive;\n                    payBehavesChart.push(payBehavTotalFiveObjectChart);\n\n                    let payBehavTotalFivePObjectChart = new Object();\n                    payBehavTotalFivePObjectChart.name = '付费人数';\n                    payBehavTotalFivePObjectChart.payNum = '(200,500]';\n                    payBehavTotalFivePObjectChart.value = payBehavTotalFiveP;\n                    payBehavesChart.push(payBehavTotalFivePObjectChart);\n\n                    let payBehavTotalSixObjectChart = new Object();\n                    payBehavTotalSixObjectChart.name = '付费额';\n                    payBehavTotalSixObjectChart.payNum = '(500,1000]';\n                    payBehavTotalSixObjectChart.value = payBehavTotalSix;\n                    payBehavesChart.push(payBehavTotalSixObjectChart);\n\n                    let payBehavTotalSixPObjectChart = new Object();\n                    payBehavTotalSixPObjectChart.name = '付费人数';\n                    payBehavTotalSixPObjectChart.payNum = '(500,1000]';\n                    payBehavTotalSixPObjectChart.value = payBehavTotalSixP;\n                    payBehavesChart.push(payBehavTotalSixPObjectChart);\n\n                    let payBehavTotalSevenObjectChart = new Object();\n                    payBehavTotalSevenObjectChart.name = '付费额';\n                    payBehavTotalSevenObjectChart.payNum = '1000以上';\n                    payBehavTotalSevenObjectChart.value = payBehavTotalSeven;\n                    payBehavesChart.push(payBehavTotalSevenObjectChart);\n\n                    let payBehavTotalSevenPObjectChart = new Object();\n                    payBehavTotalSevenPObjectChart.name = '付费人数';\n                    payBehavTotalSevenPObjectChart.payNum = '1000以上';\n                    payBehavTotalSevenPObjectChart.value = payBehavTotalSevenP;\n                    payBehavesChart.push(payBehavTotalSevenPObjectChart);\n\n                    this.payBehavs = payBehavs;\n                    this.payBehavesChart = payBehavesChart;\n                    this.charts = charts;\n                    this.surveyOneLine.changeData(this.charts);\n                    this.pyaGroupChart.changeData(this.payBehavesChart);\n                }\n            })\n        },\n        reportLineChart() {\n            // 分组柱状图\n            this.pyaGroupChart = new G2.Chart({\n                container: 'payChartGroup',\n                forceFit: true,\n                height: 300\n            });\n            this.pyaGroupChart.source(this.payBehavesChart);\n            this.pyaGroupChart.interval().position('payNum*value').color('name')\n                .adjust([{\n                    type: 'dodge',\n                    marginRatio: 1 / 32\n                }]);\n            this.pyaGroupChart.render();\n            // 折线图\n            this.surveyOneLine = new G2.Chart({\n                container: 'payChart',\n                forceFit: true,\n                height: 300\n            });\n            this.surveyOneLine.source(this.handelRetentionOne, {});\n            this.surveyOneLine.scale('value', {\n                min: 0,\n                alias: '人均付费次数',\n            });\n            this.surveyOneLine.scale('ds', {\n                // range: [0, 1]\n                tickCount: 6,\n            });\n            this.surveyOneLine.tooltip({\n                crosshairs: {\n                    type: 'line'\n                }\n            });\n            // 坐标轴文本旋转\n            this.surveyOneLine.axis('ds', {\n                label: {\n                    rotate: -Math.PI / 2.5,\n                    textAlign: 'end',\n                    textBaseline: 'middle'\n                }\n            });\n            this.surveyOneLine.line().position('ds*value').shape('smooth');\n            this.surveyOneLine.point().position('ds*value')\n                .size(4)\n                .shape('circle')\n                .style({\n                    stroke: '#fff',\n                    lineWidth: 1\n                })\n                .color('l(0) 0:#1E90FF 0.5:#1E90FF 1:#1E90FF');\n            this.surveyOneLine.area().position('ds*value').shape('smooth');\n            this.surveyOneLine.render();\n        },\n        compare: function (obj1, obj2) {\n            var val1 = obj1.ds;\n            var val2 = obj2.ds;\n            if (val1 < val2) {\n                return 1;\n            } else if (val1 > val2) {\n                return -1;\n            } else {\n                return 0;\n            }\n        },\n        compareR: function (obj1, obj2) {\n            var val1 = obj1.ds;\n            var val2 = obj2.ds;\n            if (val1 < val2) {\n                return -1;\n            } else if (val1 > val2) {\n                return 1;\n            } else {\n                return 0;\n            }\n        },\n    },\n    mounted() {\n        this.reportLineChart();\n        this.init();\n    },\n}\n",{"version":3,"sources":["reportPayBehav.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmDA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"reportPayBehav.vue","sourceRoot":"src/views/reportData/reportPayBehav","sourcesContent":["<template>\n    <div style=\"background-color:#fff;\">\n        <!--时间-->\n        <div style=\"margin-bottom: 20px\">\n            <RadioGroup v-model=\"data\" type=\"button\" @on-change=\"init()\">>\n                <Radio style=\"margin: 10px 10px\" label=\"1\">昨天</Radio>\n                <Radio style=\"margin: 10px 10px\" label=\"7\">7日</Radio>\n                <Radio style=\"margin: 10px 10px\" label=\"30\">30日</Radio>\n            </RadioGroup>\n        </div>\n        <!--        <div @mouseleave=\"leave()\" style=\"width: 45px\" class=\"conditionHead\">-->\n        <!--            <div style=\"width: 45px;height: 35px;\" class=\"smillPeople\"-->\n        <!--                 @mouseenter=\"enter\"></div>-->\n        <!--            <div v-show=\"isShowCondition\"-->\n        <!--                 style=\"width: 270px;height: 150px;background-color:#EAEAEA;z-index: 999;opacity: 0.9;border-radius: 10px 10px 10px 10px;\">-->\n        <!--             -->\n        <!--            </div>-->\n        <!--        </div>-->\n\n        <div style=\"width: 47%;position: absolute\">\n            <vTitleHead :inputName=\"payHevChart\"></vTitleHead>\n            <div style=\"background-color:#fff; border-radius: 0 0 10px 10px\" id=\"payChartGroup\"></div>\n        </div>\n\n        <div style=\"width: 47%;position: relative;left: 50%\">\n            <vTitleHead :inputName=\"payHevChartLine\"></vTitleHead>\n            <div style=\"background-color:#fff; border-radius: 0 0 10px 10px\" id=\"payChart\"></div>\n        </div>\n\n        <!--        <div style=\"width: 47%;margin-top:50px;position: absolute\">-->\n        <div>\n            <vTitleHead :inputName=\"payHevTableMoney\"></vTitleHead>\n            <Row>\n                <Table :loading=\"isLoading\" height=\"400\" highlight-row border :columns=\"columnsPay\" :data=\"payBehavs\"\n                       ref=\"table\"></Table>\n            </Row>\n        </div>\n\n        <!--        <div style=\"width: 47%;position: relative;left: 50%;top: 50px\">-->\n        <div>\n            <vTitleHead :inputName=\"payHevTablePeople\"></vTitleHead>\n            <Row>\n                <Table height=\"400\" highlight-row border :columns=\"columnsPayPeople\" :data=\"payBehavs\"\n                       ref=\"table\"></Table>\n            </Row>\n        </div>\n\n    </div>\n</template>\n\n<script>\n    import {queryPaymentBehavior} from '@/api/index';\n    import {weekChange} from '@/libs/changeWeek';\n    import vTitleHead from '../../game/template/TitleHead';\n\n    export default {\n        name: \"reportPayBehav\",\n        components: {vTitleHead},\n        data() {\n            return {\n                isLoading:true,\n                payHevChart: '付费行为汇总',\n                payHevChartLine: '人均付费',\n                payHevTableMoney: '付费额（元）',\n                payHevTablePeople: '付费人数',\n                isShowCondition: false,\n                defaultData: {\n                    yestoday: 1,\n                    week: 7,\n                    month: 30\n                },\n                data: \"7\",\n                payBehavs: [],\n                payBehavesChart: [],\n                charts: [],\n                columnsPay: [\n                    {\n                        title: '日期（星期）',\n                        key: 'ds',\n                        width: 150,\n                        align: 'center',\n                        fixed: 'left'\n                    },\n                    {\n                        title: '[0,10}',\n                        key: 'one',\n                        align: 'center',\n                        width: 150\n                    },\n                    {\n                        title: '(10,50]',\n                        key: 'two',\n                        align: 'center',\n                        width: 150\n                    },\n                    {\n                        title: '(50,100]',\n                        key: 'three',\n                        align: 'center',\n                        width: 150\n                    },\n                    {\n                        title: '(100,200]',\n                        key: 'foure',\n                        align: 'center',\n                        width: 150\n                    },\n                    {\n                        title: '(200,500]',\n                        key: 'five',\n                        align: 'center',\n                        width: 150\n                    },\n                    {\n                        title: '(500,1000]',\n                        key: 'six',\n                        align: 'center',\n                        width: 150\n                    },\n                    {\n                        title: '1000以上',\n                        key: 'seven',\n                        // width: 150\n                    }\n                ],\n                columnsPayPeople: [\n                    {\n                        title: '日期（星期）',\n                        key: 'ds',\n                        width: 150,\n                        align: 'center',\n                        fixed: 'left'\n                    },\n                    {\n                        title: '[0,10}',\n                        key: 'onePeople',\n                        align: 'center',\n                        width: 150\n                    },\n                    {\n                        title: '(10,50]',\n                        key: 'twoPeople',\n                        align: 'center',\n                        width: 150\n                    },\n                    {\n                        title: '(50,100]',\n                        key: 'threePeople',\n                        align: 'center',\n                        width: 150\n                    },\n                    {\n                        title: '(100,200]',\n                        key: 'fourePeople',\n                        align: 'center',\n                        width: 150\n                    },\n                    {\n                        title: '(200,500]',\n                        key: 'fivePeople',\n                        align: 'center',\n                        width: 150\n                    },\n                    {\n                        title: '(500,1000]',\n                        key: 'sixPeople',\n                        align: 'center',\n                        width: 150\n                    },\n                    {\n                        title: '1000以上',\n                        key: 'sevenPeople',\n                        // width: 150\n                    }\n                ],\n                pyaGroupChart: {},\n                surveyOneLine: {},\n            }\n        },\n        methods: {\n            enter() {\n                this.isShowCondition = true;\n            },\n            leave() {\n                this.isShowCondition = false;\n            },\n            init() {\n                this.isLoading = true;\n                this.queryPay();\n            },\n            queryPay() {\n                let params = {\n                    gameid: parseInt(this.getStore('gameid')),\n                    date: parseInt(this.data)\n                };\n                queryPaymentBehavior(params).then(e => {\n                    this.isLoading = false;\n                    if (e.success) {\n                        let shareDailyResultTypes = e.shareDailyResultTypes;\n                        let payBehav = e.payBehavMap;\n\n                        let payBehavs = [];\n                        let numberMap = new Map();\n                        for (let key in payBehav) {\n                            //每天总付费次数\n                            let i = 0;\n                            for (let keys in payBehav[key]) {\n                                i += payBehav[key][keys].length;\n                            }\n                            numberMap.set(key, i);\n\n                            let payBehavObject = new Object();\n                            payBehavObject.ds = weekChange(key);\n\n                            let sunMoneyOne = 0,\n                                sunMoneyTwo = 0,\n                                sunMoneyThree = 0,\n                                sunMoneyFoure = 0,\n                                sunMoneyFive = 0,\n                                sunMoneySix = 0,\n                                sunMoneySeven = 0;\n                            let peopleSetOne = new Set(),\n                                peopleSetTwo = new Set(),\n                                peopleSetThree = new Set(),\n                                peopleSetFoure = new Set(),\n                                peopleSetFive = new Set(),\n                                peopleSetSix = new Set(),\n                                peopleSetSeven = new Set();\n\n                            payBehav[key].collectOne.forEach(item => {\n                                sunMoneyOne += item.amount;\n                                peopleSetOne.add(item.userid);\n                            })\n                            let sumPeopleOne = peopleSetOne.size;\n                            payBehavObject.one = sunMoneyOne / this.getStore(\"currencyRate\");\n                            payBehavObject.onePeople = sumPeopleOne;\n\n                            payBehav[key].collectTwo.forEach(item => {\n                                sunMoneyTwo += item.amount;\n                                peopleSetTwo.add(item.userid);\n                            })\n                            let sumPeopleTwo = peopleSetTwo.size;\n                            payBehavObject.two = sunMoneyTwo / this.getStore(\"currencyRate\");\n                            payBehavObject.twoPeople = sumPeopleTwo;\n\n                            payBehav[key].collectThree.forEach(item => {\n                                sunMoneyThree += item.amount;\n                                peopleSetThree.add(item.userid);\n                            })\n                            let sumPeopleThree = peopleSetThree.size;\n                            payBehavObject.three = sunMoneyThree / this.getStore(\"currencyRate\");\n                            payBehavObject.threePeople = sumPeopleThree;\n\n                            payBehav[key].collectFoure.forEach(item => {\n                                sunMoneyFoure += item.amount;\n                                peopleSetFoure.add(item.userid);\n                            })\n                            let sumPeopleFoure = peopleSetFoure.size;\n                            payBehavObject.foure = sunMoneyFoure / this.getStore(\"currencyRate\");\n                            payBehavObject.fourePeople = sumPeopleFoure;\n\n                            payBehav[key].collectFive.forEach(item => {\n                                sunMoneyFive += item.amount;\n                                peopleSetFive.add(item.userid);\n                            })\n                            let sumPeopleFive = peopleSetFive.size;\n                            payBehavObject.five = sunMoneyFive / this.getStore(\"currencyRate\");\n                            payBehavObject.fivePeople = sumPeopleFive;\n\n                            payBehav[key].collectSix.forEach(item => {\n                                sunMoneySix += item.amount;\n                                peopleSetSix.add(item.userid);\n                            })\n                            let sumPeopleSix = peopleSetSix.size;\n                            payBehavObject.six = sunMoneySix / this.getStore(\"currencyRate\");\n                            payBehavObject.sixPeople = sumPeopleSix;\n\n                            payBehav[key].collectSeven.forEach(item => {\n                                sunMoneySeven += item.amount;\n                                peopleSetSeven.add(item.userid);\n                            })\n                            let sumPeopleSeven = peopleSetSeven.size;\n                            payBehavObject.seven = sunMoneySeven / this.getStore(\"currencyRate\");\n                            payBehavObject.sevenPeople = sumPeopleSeven;\n\n                            payBehavs.push(payBehavObject);\n                        }\n\n                        //折线图\n                        let charts = [];\n                        shareDailyResultTypes.sort(this.compareR);\n                        shareDailyResultTypes.forEach(item => {\n                            let i = item.dauNum == 0 ? 0 : ((numberMap.get(item.ds) || 0) / item.dauNum).toFixed(3);\n                            let chartObject = new Object();\n                            chartObject.ds = item.ds.substr(5, 5);\n                            chartObject.value = i;\n                            charts.push(chartObject);\n                        })\n\n                        payBehavs.sort(this.compare);\n\n                        //付费行为汇总--分组柱状图\n                        let payBehavTotalOne = 0,\n                            payBehavTotalOneP = 0,\n                            payBehavTotalTwo = 0,\n                            payBehavTotalTwoP = 0,\n                            payBehavTotalThree = 0,\n                            payBehavTotalThreeP = 0,\n                            payBehavTotalFoure = 0,\n                            payBehavTotalFoureP = 0,\n                            payBehavTotalFive = 0,\n                            payBehavTotalFiveP = 0,\n                            payBehavTotalSix = 0,\n                            payBehavTotalSixP = 0,\n                            payBehavTotalSeven = 0,\n                            payBehavTotalSevenP = 0;\n\n                        payBehavs.forEach(item => {\n                            payBehavTotalOne += item.one;\n                            payBehavTotalOneP += item.onePeople;\n                            payBehavTotalTwo += item.two;\n                            payBehavTotalTwoP += item.twoPeople;\n                            payBehavTotalThree += item.three;\n                            payBehavTotalThreeP += item.threePeople;\n                            payBehavTotalFoure += item.foure;\n                            payBehavTotalFoureP += item.fourePeople;\n                            payBehavTotalFive += item.five;\n                            payBehavTotalFiveP += item.fivePeople;\n                            payBehavTotalSix += item.six;\n                            payBehavTotalSixP += item.sixPeople;\n                            payBehavTotalSeven += item.seven;\n                            payBehavTotalSevenP += item.sevenPeople;\n                        })\n\n                        let payBehavesChart = [];\n\n                        let payBehavTotalOneObjectChart = new Object();\n                        payBehavTotalOneObjectChart.name = '付费额';\n                        payBehavTotalOneObjectChart.payNum = '[0,10]';\n                        payBehavTotalOneObjectChart.value = payBehavTotalOne;\n                        payBehavesChart.push(payBehavTotalOneObjectChart);\n\n                        let payBehavTotalOnePObjectChart = new Object();\n                        payBehavTotalOnePObjectChart.name = '付费人数';\n                        payBehavTotalOnePObjectChart.payNum = '[0,10]';\n                        payBehavTotalOnePObjectChart.value = payBehavTotalOneP;\n                        payBehavesChart.push(payBehavTotalOnePObjectChart);\n\n                        let payBehavTotalTwoObjectChart = new Object();\n                        payBehavTotalTwoObjectChart.name = '付费额';\n                        payBehavTotalTwoObjectChart.payNum = '(10,50]';\n                        payBehavTotalTwoObjectChart.value = payBehavTotalTwo;\n                        payBehavesChart.push(payBehavTotalTwoObjectChart);\n\n                        let payBehavTotalTwoPObjectChart = new Object();\n                        payBehavTotalTwoPObjectChart.name = '付费人数';\n                        payBehavTotalTwoPObjectChart.payNum = '(10,50]';\n                        payBehavTotalTwoPObjectChart.value = payBehavTotalTwoP;\n                        payBehavesChart.push(payBehavTotalTwoPObjectChart);\n\n                        let payBehavTotalThreeObjectChart = new Object();\n                        payBehavTotalThreeObjectChart.name = '付费额';\n                        payBehavTotalThreeObjectChart.payNum = '(50,100]';\n                        payBehavTotalThreeObjectChart.value = payBehavTotalThree;\n                        payBehavesChart.push(payBehavTotalThreeObjectChart);\n\n                        let payBehavTotalThreePObjectChart = new Object();\n                        payBehavTotalThreePObjectChart.name = '付费人数';\n                        payBehavTotalThreePObjectChart.payNum = '(50,100]';\n                        payBehavTotalThreePObjectChart.value = payBehavTotalThreeP;\n                        payBehavesChart.push(payBehavTotalThreePObjectChart);\n\n                        let payBehavTotalFoureObjectChart = new Object();\n                        payBehavTotalFoureObjectChart.name = '付费额';\n                        payBehavTotalFoureObjectChart.payNum = '(100,200]';\n                        payBehavTotalFoureObjectChart.value = payBehavTotalFoure;\n                        payBehavesChart.push(payBehavTotalFoureObjectChart);\n\n                        let payBehavTotalFourePObjectChart = new Object();\n                        payBehavTotalFourePObjectChart.name = '付费人数';\n                        payBehavTotalFourePObjectChart.payNum = '(100,200]';\n                        payBehavTotalFourePObjectChart.value = payBehavTotalFoureP;\n                        payBehavesChart.push(payBehavTotalFourePObjectChart);\n\n                        let payBehavTotalFiveObjectChart = new Object();\n                        payBehavTotalFiveObjectChart.name = '付费额';\n                        payBehavTotalFiveObjectChart.payNum = '(200,500]';\n                        payBehavTotalFiveObjectChart.value = payBehavTotalFive;\n                        payBehavesChart.push(payBehavTotalFiveObjectChart);\n\n                        let payBehavTotalFivePObjectChart = new Object();\n                        payBehavTotalFivePObjectChart.name = '付费人数';\n                        payBehavTotalFivePObjectChart.payNum = '(200,500]';\n                        payBehavTotalFivePObjectChart.value = payBehavTotalFiveP;\n                        payBehavesChart.push(payBehavTotalFivePObjectChart);\n\n                        let payBehavTotalSixObjectChart = new Object();\n                        payBehavTotalSixObjectChart.name = '付费额';\n                        payBehavTotalSixObjectChart.payNum = '(500,1000]';\n                        payBehavTotalSixObjectChart.value = payBehavTotalSix;\n                        payBehavesChart.push(payBehavTotalSixObjectChart);\n\n                        let payBehavTotalSixPObjectChart = new Object();\n                        payBehavTotalSixPObjectChart.name = '付费人数';\n                        payBehavTotalSixPObjectChart.payNum = '(500,1000]';\n                        payBehavTotalSixPObjectChart.value = payBehavTotalSixP;\n                        payBehavesChart.push(payBehavTotalSixPObjectChart);\n\n                        let payBehavTotalSevenObjectChart = new Object();\n                        payBehavTotalSevenObjectChart.name = '付费额';\n                        payBehavTotalSevenObjectChart.payNum = '1000以上';\n                        payBehavTotalSevenObjectChart.value = payBehavTotalSeven;\n                        payBehavesChart.push(payBehavTotalSevenObjectChart);\n\n                        let payBehavTotalSevenPObjectChart = new Object();\n                        payBehavTotalSevenPObjectChart.name = '付费人数';\n                        payBehavTotalSevenPObjectChart.payNum = '1000以上';\n                        payBehavTotalSevenPObjectChart.value = payBehavTotalSevenP;\n                        payBehavesChart.push(payBehavTotalSevenPObjectChart);\n\n                        this.payBehavs = payBehavs;\n                        this.payBehavesChart = payBehavesChart;\n                        this.charts = charts;\n                        this.surveyOneLine.changeData(this.charts);\n                        this.pyaGroupChart.changeData(this.payBehavesChart);\n                    }\n                })\n            },\n            reportLineChart() {\n                // 分组柱状图\n                this.pyaGroupChart = new G2.Chart({\n                    container: 'payChartGroup',\n                    forceFit: true,\n                    height: 300\n                });\n                this.pyaGroupChart.source(this.payBehavesChart);\n                this.pyaGroupChart.interval().position('payNum*value').color('name')\n                    .adjust([{\n                        type: 'dodge',\n                        marginRatio: 1 / 32\n                    }]);\n                this.pyaGroupChart.render();\n                // 折线图\n                this.surveyOneLine = new G2.Chart({\n                    container: 'payChart',\n                    forceFit: true,\n                    height: 300\n                });\n                this.surveyOneLine.source(this.handelRetentionOne, {});\n                this.surveyOneLine.scale('value', {\n                    min: 0,\n                    alias: '人均付费次数',\n                });\n                this.surveyOneLine.scale('ds', {\n                    // range: [0, 1]\n                    tickCount: 6,\n                });\n                this.surveyOneLine.tooltip({\n                    crosshairs: {\n                        type: 'line'\n                    }\n                });\n                // 坐标轴文本旋转\n                this.surveyOneLine.axis('ds', {\n                    label: {\n                        rotate: -Math.PI / 2.5,\n                        textAlign: 'end',\n                        textBaseline: 'middle'\n                    }\n                });\n                this.surveyOneLine.line().position('ds*value').shape('smooth');\n                this.surveyOneLine.point().position('ds*value')\n                    .size(4)\n                    .shape('circle')\n                    .style({\n                        stroke: '#fff',\n                        lineWidth: 1\n                    })\n                    .color('l(0) 0:#1E90FF 0.5:#1E90FF 1:#1E90FF');\n                this.surveyOneLine.area().position('ds*value').shape('smooth');\n                this.surveyOneLine.render();\n            },\n            compare: function (obj1, obj2) {\n                var val1 = obj1.ds;\n                var val2 = obj2.ds;\n                if (val1 < val2) {\n                    return 1;\n                } else if (val1 > val2) {\n                    return -1;\n                } else {\n                    return 0;\n                }\n            },\n            compareR: function (obj1, obj2) {\n                var val1 = obj1.ds;\n                var val2 = obj2.ds;\n                if (val1 < val2) {\n                    return -1;\n                } else if (val1 > val2) {\n                    return 1;\n                } else {\n                    return 0;\n                }\n            },\n        },\n        mounted() {\n            this.reportLineChart();\n            this.init();\n        },\n    }\n</script>\n\n<style scoped>\n    .conditionHead {\n        position: fixed;\n        left: 35%;\n        top: 120px;\n        z-index: 999;\n    }\n\n    .smillPeople {\n        width: 45px;\n        height: 35px;\n        background-image: url(../../../assets/smillPeople.jpg);\n        background-size: 300px 35px;\n        animation: walk1 1s steps(7) infinite;\n    }\n\n    @keyframes walk1 {\n        0% {\n            background-position: 0;\n        }\n\n        100% {\n            background-position: 300px;\n        }\n    }\n</style>\n"]}]}