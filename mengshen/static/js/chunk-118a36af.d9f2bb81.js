(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-118a36af","chunk-8d965cd6"],{"16a8":function(e,t,a){"use strict";var i=a("7e18"),n=a.n(i);n.a},"3ac2":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"titleHead"},[e._v(e._s(e.inputName))])},n=[],r={name:"TitleHead",props:{inputName:String,required:!0},components:{},data:function(){return{}},mounted:function(){},methods:{}},s=r,l=(a("16a8"),a("2877")),c=Object(l["a"])(s,i,n,!1,null,"111682f2",null);t["default"]=c.exports},"3f27":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var i=function(e){var t=new Date(e),a=t.getDay(),i=7-a;switch(i){case 7:e+="(七)";break;case 1:e+="(六)";break;case 2:e+="(五)";break;case 3:e+="(四)";break;case 4:e+="(三)";break;case 5:e+="(二)";break;case 6:e+="(一)";break;default:}return e}},"7e18":function(e,t,a){},e6c0:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"background-color":"#fff"}},[a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}]},[a("RadioGroup",{attrs:{type:"button"},on:{"on-change":function(t){return e.init()}},model:{value:e.searchForm.source,callback:function(t){e.$set(e.searchForm,"source",t)},expression:"searchForm.source"}},[a("Radio",{staticStyle:{margin:"10px 10px"},attrs:{label:"0"}},[e._v("用户")]),a("Radio",{staticStyle:{margin:"10px 10px"},attrs:{label:"1"}},[e._v("设备")])],1)],1),a("div",[a("RadioGroup",{attrs:{type:"button"},on:{"on-change":function(t){return e.init()}},model:{value:e.searchForm.os,callback:function(t){e.$set(e.searchForm,"os",t)},expression:"searchForm.os"}},[a("Radio",{staticStyle:{margin:"10px 10px"},attrs:{label:"0"}},[a("span",[e._v("ALL")])]),a("Radio",{staticStyle:{margin:"10px 10px"},attrs:{label:"1"}},[a("span",[e._v("ANDROID")])]),a("Radio",{staticStyle:{margin:"10px 10px"},attrs:{label:"2"}},[a("span",[e._v("IOS")])]),a("Radio",{staticStyle:{margin:"10px 10px"},attrs:{label:"-1"}},[a("span",[e._v("NONE")])])],1)],1),a("div",[a("RadioGroup",{attrs:{type:"button"},on:{"on-change":function(t){return e.init()}},model:{value:e.searchForm.day,callback:function(t){e.$set(e.searchForm,"day",t)},expression:"searchForm.day"}},[e._v(">\n                "),a("Radio",{staticStyle:{margin:"10px 10px"},attrs:{label:"0"}},[e._v("今天")]),a("Radio",{staticStyle:{margin:"10px 10px"},attrs:{label:"1"}},[e._v("昨天")]),a("Radio",{staticStyle:{margin:"10px 10px"},attrs:{label:"7"}},[e._v("7天")]),a("Radio",{staticStyle:{margin:"10px 10px"},attrs:{label:"30"}},[e._v("30天")])],1)],1),a("div",[a("RadioGroup",{attrs:{type:"button"},on:{"on-change":function(t){return e.showclients(e.key)}},model:{value:e.key,callback:function(t){e.key=t},expression:"key"}},[e._v(">\n                "),a("Radio",{staticStyle:{margin:"10px 10px"},attrs:{label:"all"}},[e._v("概况")]),a("Radio",{staticStyle:{margin:"10px 10px"},attrs:{label:"creative"}},[e._v("渠道")]),a("Radio",{staticStyle:{margin:"10px 10px"},attrs:{label:"client"}},[e._v("分服")])],1)],1),a("Form",{ref:"searchForm",staticClass:"search-form",attrs:{model:e.searchForm,inline:"","label-width":70}},[e.showcreative?a("Form-item",{attrs:{label:"",prop:"creative"}},[a("Select",{staticStyle:{width:"200px"},on:{"on-change":function(t){return e.init()}},model:{value:e.searchForm.creative,callback:function(t){e.$set(e.searchForm,"creative",t)},expression:"searchForm.creative"}},e._l(e.creativemap,(function(t){return a("Option",{key:t.key,attrs:{value:t.key}},[e._v(e._s(t.name))])})),1)],1):e._e(),e.showclient?a("Form-item",{attrs:{label:"",prop:"client"}},[a("Select",{staticStyle:{width:"200px"},on:{"on-change":function(t){return e.init()}},model:{value:e.searchForm.clientid,callback:function(t){e.$set(e.searchForm,"clientid",t)},expression:"searchForm.clientid"}},e._l(e.clientmap,(function(t){return a("Option",{key:t.key,attrs:{value:t.key}},[e._v(e._s(t.name))])})),1)],1):e._e()],1)],1),a("div",[a("vTitleHead",{attrs:{inputName:e.payLine}}),a("div",{staticStyle:{"background-color":"#fff","border-radius":"0 0 10px 10px"},attrs:{id:"surveyManyLine"}})],1),a("div",{staticStyle:{"margin-top":"20px"}},[a("vTitleHead",{attrs:{inputName:e.payTable}}),a("Row",[a("Table",{ref:"table",attrs:{loading:e.loadPay,height:"420",border:"",columns:e.columnspro,data:e.data,sortable:"custom"}})],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.payRenDayTitlessShow,expression:"payRenDayTitlessShow"}],staticStyle:{"margin-top":"20px"}},[a("vTitleHead",{attrs:{inputName:e.payRenDayTitless}}),a("Row",[a("Table",{ref:"table",attrs:{height:"420",loading:e.loading,border:"",columns:e.payRenDayTitles,data:e.retentionTitlestable,sortable:"custom"}})],1)],1),e.showcc?a("div",{staticStyle:{"margin-top":"20px"}},[a("vTitleHead",{attrs:{inputName:e.payTableAI}}),a("Row",[a("Table",{ref:"table",attrs:{height:"420","highlight-row":"",border:"",columns:e.columnscc,data:e.sharePayResultTypesCC}})],1)],1):e._e()])},n=[],r=a("365c"),s=a("3ac2"),l=a("3f27"),c={name:"pay",components:{vTitleHead:s["default"]},comments:{},data:function(){return{payRenDayTitles:[{title:"日期（星期）",key:"ds",width:120,align:"center"},{title:"注册数",key:"dr",width:80,align:"center"},{title:"1日",key:"0day",width:80,align:"center"},{title:"2日",key:"1day",width:80,align:"center"},{title:"3日",key:"2day",width:80,align:"center"},{title:"4日",key:"3day",width:80,align:"center"},{title:"5日",key:"4day",width:80,align:"center"},{title:"6日",key:"5day",width:80,align:"center"},{title:"7日",key:"6day",width:80,align:"center"},{title:"8日",key:"7day",width:80,align:"center"},{title:"9日",key:"8day",width:80,align:"center"},{title:"10日",key:"9day",width:80,align:"center"},{title:"11日",key:"10day",width:80,align:"center"},{title:"12日",key:"11day",width:80,align:"center"},{title:"13日",key:"12day",width:80,align:"center"},{title:"14日",key:"13day",width:80,align:"center"},{title:"15日",key:"14day",width:80,align:"center"},{title:"16日",key:"15day",width:80,align:"center"},{title:"17日",key:"16day",width:80,align:"center"},{title:"18日",key:"17day",width:80,align:"center"},{title:"19日",key:"18day",width:80,align:"center"},{title:"20日",key:"19day",width:80,align:"center"},{title:"21日",key:"20day",width:80,align:"center"},{title:"22日",key:"21day",width:80,align:"center"},{title:"23日",key:"22day",width:80,align:"center"},{title:"24日",key:"23day",width:80,align:"center"},{title:"25日",key:"24day",width:80,align:"center"},{title:"26日",key:"25day",width:80,align:"center"},{title:"27日",key:"26day",width:80,align:"center"},{title:"28日",key:"27day",width:80,align:"center"},{title:"29日",key:"28day",width:80,align:"center"},{title:"30日",key:"29day",width:80,align:"center"}],loadPay:!0,isShow:!0,payLine:"付费趋势",payTable:"付费详情(元)",payRenDayTitless:"注收比",payRenDayTitlessShow:!0,payTableAI:"付费详情(Android/iOS)",columnspro:[],columns:[{title:"日期(星期)",key:"ds",width:150,align:"center"},{title:"操作系统",key:"os",width:100,align:"center",checkAccess:[2]},{title:"小时",key:"dayOfHour",width:80,align:"center",checkAccess:[3]},{title:"渠道",key:"creative",width:80,align:"center",checkAccess:[4]},{title:"服",key:"client",checkAccess:[1],width:80,align:"center"},{title:"活跃数",key:"dauNum",width:80,align:"center"},{title:"注册数",key:"installNum",width:80,align:"center"},{title:"付费率（%）",key:"payRate",align:"center",width:120},{title:"ARPU",key:"ARPU",align:"center",width:80},{title:"ARPPU",key:"ARPPU",align:"center",width:80},{title:"付费人数",key:"payCount",align:"center",width:100},{title:"付费总额",key:"payAmount",align:"center",width:100},{title:"注册付费率（%）",key:"payInstallRate",align:"center",width:140},{title:"注册付费ARPU",key:"payInstallARPU",align:"center",width:150},{title:"注册付费ARPPU",key:"payInstallARPPU",align:"center",width:150},{title:"注册付费人数",key:"payInstallCount",width:120,align:"center"},{title:"注册付费金额",key:"payInstallAmount",width:120,align:"center"},{title:"注册付费次数",key:"payInstallTimes"}],columnscc:[{title:"日期(星期)",key:"ds",align:"center",width:150},{title:"操作系统",key:"os",width:100,align:"center",checkAccess:[2]},{title:"活跃数",key:"dauNum",width:80,align:"center"},{title:"注册数",key:"installNum",width:80,align:"center"},{title:"付费率（%）",key:"payRate",align:"center",width:120},{title:"ARPU",key:"ARPU",align:"center",width:80},{title:"ARPPU",key:"ARPPU",align:"center",width:80},{title:"付费人数",key:"payCount",align:"center",width:100},{title:"付费总额",key:"payAmount",align:"center",width:100},{title:"注册付费率（%）",key:"payInstallRate",align:"center",width:140},{title:"注册付费ARPU",key:"payInstallARPU",align:"center",width:150},{title:"注册付费ARPPU",key:"payInstallARPPU",align:"center",width:150},{title:"注册付费人数",key:"payInstallCount",width:120,align:"center"},{title:"注册付费金额",key:"payInstallAmount",width:120,align:"center"},{title:"注册付费次数",key:"payInstallTimes"}],data:[],searchForm:{source:"0",creativeid:"",clientid:"",gameid:parseInt(this.getStore("gameid")),day:"7",os:"0",page:1},total:0,games:[],retentionTitlestable:[],sharePayResultTypesCC:[],creatives:[],clients:[],clientmap:[],creativemap:[],surveyManyLine:{},handelPayCount:[],key:"all",showcreative:!1,showclient:!1,showcc:!0}},methods:{init:function(){this.loadPay=!0,0==this.getStore("parentId")?this.isShow=!0:this.isShow=!1,this.queryAllServer(),"all"!=this.key?this.payRenDayTitlessShow=!1:this.payRenDayTitlessShow=!0},handleSearch:function(){this.queryAllServer()},queryAllServer:function(){var e=this;this.columnspro=JSON.parse(JSON.stringify(this.columns)),0!=this.searchForm.day&&1!=this.searchForm.day&&this.handleColumns(3),0==this.searchForm.os&&""==this.searchForm.clientid&&null==this.searchForm.creative&&this.handleColumns(2),""==this.searchForm.clientid&&this.handleColumns(1),null==this.searchForm.creative&&this.handleColumns(4),Object(r["Nb"])(this.searchForm).then((function(t){if(e.loadPay=!1,t.success){e.data=t.msg,e.sharePayResultTypesCC=t.sharePayResultTypesCC,e.creatives=t.creatives,e.clients=t.clients,e.surveyManyLine.changeData(e.handelPayCount),e.creativemap=t.creatives.map((function(e){return{key:e.creativeid,name:e.creativeName}}));var a=new Object;a.key="0",a.name="全渠道",e.creativemap.unshift(a);var i=new Map;e.creativemap.forEach((function(e,t){i.set(e.key,e.name)})),e.clientmap=t.clients.map((function(e){return{key:e.serverid,name:e.serverName}}));var n=new Object;n.key="-1",n.name="所有服",e.clientmap.unshift(n);var r=new Map;e.clientmap.forEach((function(e,t){r.set(e.key,e.name)})),e.tableDataProcess(e.data,i,r),e.tableDataProcess(e.sharePayResultTypesCC,i,r),e.handelPayCount=e.makeCavas(e.data,e.searchForm.day),e.surveyManyLine.changeData(e.handelPayCount)}}));var t={gameid:this.searchForm.gameid,day:this.searchForm.day,os:this.searchForm.os};Object(r["Ub"])(t).then((function(t){if(t.success){var a=e.tableDataProcessa(t.msg),i=e.tableDataProcessb(t.msgOS);"0"==e.searchForm.os?e.retentionTitlestable=a:e.retentionTitlestable=i}}))},tableDataProcessa:function(e){if(e){var t=[],a=function(a){var i={};i.ds=Object(l["a"])(e[a][0].ds);for(var n=0;n<=29;n++)i[n+"day"]=0;e[a].forEach((function(e){i.dr=e.dr;for(var t=e.date;t<=e.day;t++)i[t+"day"]=e.income})),t.push(i)};for(var i in e)a(i);e=t}return e},tableDataProcessb:function(e){if(e){var t=[],a=function(a){var i={};i.ds=Object(l["a"])(e[a][0].ds);for(var n=0;n<=29;n++)i[n+"day"]=0;e[a].forEach((function(e){i.dr=e.dr,i.os=e.os;for(var t=e.date;t<=e.day;t++)i[t+"day"]=e.income})),t.push(i)};for(var i in e)a(i);e=t}return e},showclients:function(e){"all"==e?(this.showcreative=!1,this.showclient=!1,this.showcc=!0,delete this.searchForm.creative,this.searchForm.clientid="",this.init()):"creative"==e?(this.showcreative=!0,this.showclient=!1,this.showcc=!1,this.searchForm.creative="0",this.searchForm.clientid="",this.init()):(this.showcreative=!1,this.showclient=!0,this.showcc=!1,delete this.searchForm.creative,this.searchForm.clientid="-1",this.init())},handleColumns:function(e){var t=this;this.columnspro.map((function(a,i){var n=a.checkAccess;n&&(n-Number(e)==0?t.columnspro.splice(i,1):console.log(i))}))},weekFunction:function(e){var t=new Date(e),a=t.getDay(),i=7-a;switch(i){case 7:e+="(七)";break;case 1:e+="(六)";break;case 2:e+="(五)";break;case 3:e+="(四)";break;case 4:e+="(三)";break;case 5:e+="(二)";break;case 6:e+="(一)";break;default:}return e},surveyManyLineChart:function(){this.surveyManyLine=new G2.Chart({container:"surveyManyLine",forceFit:!0,height:300}),this.surveyManyLine.source(this.handelPayCount,{}),this.surveyManyLine.scale("value",{min:0,alias:"人数"}),this.surveyManyLine.scale("time",{tickCount:9}),this.surveyManyLine.tooltip({crosshairs:{type:"line"}}),this.surveyManyLine.axis("time",{label:{rotate:-Math.PI/2.5,textAlign:"end",textBaseline:"middle"}}),this.surveyManyLine.axis("time",{label:{formatter:function(e){return e}}}),this.surveyManyLine.legend({position:"bottom",align:"center",itemWidth:null}),this.surveyManyLine.line().position("time*value").color("type").shape("smooth"),this.surveyManyLine.point().position("time*value").color("type").size(4).shape("circle").style({stroke:"#fff",lineWidth:1}),this.surveyManyLine.render()},makeCavas:function(e,t){if(e){0==t&&e.sort((function(e,t){return t.dayOfHour-e.dayOfHour}));var a=[];return e.forEach((function(e,i){var n=new Object;n.time=7!=t&&30!=t?e.dayOfHour+"时":e.ds.substr(5,5),n.value=e.payCount,n.type="付费人数",a.push(n);var r=new Object;r.time=7!=t&&30!=t?e.dayOfHour+"时":e.ds.substr(5,5),r.value=e.payAmount,r.type="付费金额",a.push(r);var s=new Object;s.time=7!=t&&30!=t?e.dayOfHour+"时":e.ds.substr(5,5),s.value=e.payTimes,s.type="付费次数",a.push(s);var l=new Object;l.time=7!=t&&30!=t?e.dayOfHour+"时":e.ds.substr(5,5),l.value=e.payInstallCount,l.type="安装付费人数",a.push(l);var c=new Object;c.time=7!=t&&30!=t?e.dayOfHour+"时":e.ds.substr(5,5),c.value=e.payInstallAmount,c.type="安装付费金额",a.push(c);var o=new Object;o.time=7!=t&&30!=t?e.dayOfHour+"时":e.ds.substr(5,5),o.value=e.payInstallTimes,o.type="安装付费次数",a.push(o)})),7!=t&&30!=t&&0!=t||a.reverse(),a}},tableDataProcess:function(e,t,a){var i=this;return e&&e.forEach((function(e){e.ds=i.weekFunction(e.ds),e.payAmount=e.payAmount/i.getStore("currencyRate"),e.payInstallAmount=e.payInstallAmount/i.getStore("currencyRate"),e.client=void 0===a.get(String(e.clientid))?e.client:a.get(String(e.clientid)),e.creative=void 0===t.get(e.creative)?e.creative:t.get(e.creative),e.payRate=0==e.dauNum?0:(100*e.payCount/e.dauNum).toFixed(2),e.ARPPU=0==e.payCount?0:(e.payAmount/e.payCount).toFixed(2),e.payInstallRate=0==e.installNum?0:(100*e.payInstallCount/e.installNum).toFixed(2),e.payInstallARPU=0==e.installNum?0:(e.payInstallAmount/e.installNum).toFixed(2),e.payInstallARPPU=0==e.payInstallCount?0:(e.payInstallAmount/e.payInstallCount).toFixed(2),e.ARPU=0==e.dauNum?0:(e.payAmount/e.dauNum).toFixed(2)})),e}},mounted:function(){this.init(),this.surveyManyLineChart()}},o=c,y=a("2877"),d=Object(y["a"])(o,i,n,!1,null,"228e1bb2",null);t["default"]=d.exports}}]);