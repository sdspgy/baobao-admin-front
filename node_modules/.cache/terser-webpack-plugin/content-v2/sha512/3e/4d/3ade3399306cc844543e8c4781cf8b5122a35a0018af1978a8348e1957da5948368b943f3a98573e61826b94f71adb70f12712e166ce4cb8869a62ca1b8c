{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-2d230c12\"],{ee40:function(e,t,a){\"use strict\";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",[a(\"Form\",{ref:\"searchForm\",staticClass:\"search-form\",attrs:{model:e.searchForm,inline:\"\",\"label-width\":70}},[a(\"Form-item\",{attrs:{label:\"按用户或设备\",prop:\"source\"}},[a(\"Select\",{staticStyle:{width:\"200px\"},model:{value:e.searchForm.source,callback:function(t){e.$set(e.searchForm,\"source\",t)},expression:\"searchForm.source\"}},[a(\"Option\",{attrs:{value:\"0\"}},[e._v(\"按用户\")]),a(\"Option\",{attrs:{value:\"1\"}},[e._v(\"按设备\")])],1)],1),a(\"Form-item\",{attrs:{label:\"按OS\",prop:\"os\"}},[a(\"Select\",{staticStyle:{width:\"200px\"},model:{value:e.searchForm.os,callback:function(t){e.$set(e.searchForm,\"os\",t)},expression:\"searchForm.os\"}},[a(\"Option\",{attrs:{value:\"0\"}},[e._v(\"all\")]),a(\"Option\",{attrs:{value:\"1\"}},[e._v(\"android\")]),a(\"Option\",{attrs:{value:\"2\"}},[e._v(\"ios\")]),a(\"Option\",{attrs:{value:\"-1\"}},[e._v(\"none\")])],1)],1),a(\"Form-item\",{attrs:{label:\"日期\",prop:\"day\"}},[a(\"Select\",{staticStyle:{width:\"200px\"},model:{value:e.searchForm.day,callback:function(t){e.$set(e.searchForm,\"day\",t)},expression:\"searchForm.day\"}},[a(\"Option\",{attrs:{value:\"0\"}},[e._v(\"今天\")]),a(\"Option\",{attrs:{value:\"1\"}},[e._v(\"昨天\")]),a(\"Option\",{attrs:{value:\"7\"}},[e._v(\"7天\")]),a(\"Option\",{attrs:{value:\"30\"}},[e._v(\"30天\")])],1)],1),a(\"Form-item\",{attrs:{label:\"渠道或分服\",prop:\"key\"}},[a(\"Select\",{staticStyle:{width:\"200px\"},on:{\"on-change\":e.showclients},model:{value:e.key,callback:function(t){e.key=t},expression:\"key\"}},[a(\"Option\",{attrs:{value:\"all\"}},[e._v(\"概况\")]),a(\"Option\",{attrs:{value:\"creative\"}},[e._v(\"渠道\")]),a(\"Option\",{attrs:{value:\"client\"}},[e._v(\"分服\")])],1)],1),e.showcreative?a(\"Form-item\",{attrs:{label:\"渠道\",prop:\"creative\"}},[a(\"Select\",{staticStyle:{width:\"200px\"},model:{value:e.searchForm.creative,callback:function(t){e.$set(e.searchForm,\"creative\",t)},expression:\"searchForm.creative\"}},e._l(e.creativemap,(function(t){return a(\"Option\",{key:t.key,attrs:{value:t.key}},[e._v(e._s(t.name))])})),1)],1):e._e(),e.showclient?a(\"Form-item\",{attrs:{label:\"分服\",prop:\"client\"}},[a(\"Select\",{staticStyle:{width:\"200px\"},model:{value:e.searchForm.clientid,callback:function(t){e.$set(e.searchForm,\"clientid\",t)},expression:\"searchForm.clientid\"}},e._l(e.clientmap,(function(t){return a(\"Option\",{key:t.key,attrs:{value:t.key}},[e._v(e._s(t.name))])})),1)],1):e._e()],1),a(\"Button\",{attrs:{type:\"primary\",icon:\"ios-search\"},on:{click:e.handleSearch}},[e._v(\"搜索\")]),a(\"div\",{attrs:{id:\"surveyManyLine\"}}),a(\"Row\",[a(\"Table\",{ref:\"table\",attrs:{loading:e.loading,border:\"\",columns:e.columnspro,data:e.data,sortable:\"custom\"}})],1),e.showcc?a(\"Row\",[a(\"Table\",{ref:\"table\",attrs:{height:\"300\",\"highlight-row\":\"\",border:\"\",columns:e.columnscc,data:e.sharePayResultTypesCC}})],1):e._e()],1)},s=[],n=a(\"365c\"),r={name:\"pay\",comments:{},data:function(){return{columnspro:[],columns:[{type:\"index\",width:60,align:\"center\",fixed:\"left\"},{title:\"日期(星期)\",key:\"ds\",width:150},{title:\"操作系统\",key:\"os\",width:150,checkAccess:[2]},{title:\"小时\",key:\"dayOfHour\",width:150,checkAccess:[3]},{title:\"渠道\",key:\"creative\",width:150,checkAccess:[4]},{title:\"服\",key:\"client\",width:150,checkAccess:[1]},{title:\"活跃数\",key:\"dauNum\",width:150},{title:\"注册数\",key:\"installNum\",width:150},{title:\"付费人数\",key:\"payCount\",width:150},{title:\"付费金额\",key:\"payAmount\",width:150},{title:\"付费率\",key:\"payRate\",width:150},{title:\"付费次数\",key:\"payTimes\",width:150},{title:\"安装付费人数\",key:\"payInstallCount\",width:150},{title:\"安装付费金额\",key:\"payInstallAmount\",width:150},{title:\"安装付费次数\",key:\"payInstallTimes\",width:150},{title:\"snid\",key:\"snid\",width:150}],columnscc:[{type:\"index\",width:60,align:\"center\",fixed:\"left\"},{title:\"日期(星期)\",key:\"ds\",width:150},{title:\"操作系统\",key:\"os\",width:150,checkAccess:[2]},{title:\"活跃数\",key:\"dauNum\",width:150},{title:\"注册数\",key:\"installNum\",width:150},{title:\"付费人数\",key:\"payCount\",width:150},{title:\"付费金额\",key:\"payAmount\",width:150},{title:\"付费次数\",key:\"payTimes\",width:150},{title:\"安装付费人数\",key:\"payInstallCount\",width:150},{title:\"安装付费金额\",key:\"payInstallAmount\",width:150},{title:\"付费率\",key:\"payRate\",width:150},{title:\"安装付费次数\",key:\"payInstallTimes\",width:150}],data:[],searchForm:{source:\"0\",creativeid:\"\",clientid:\"\",gameid:parseInt(this.getStore(\"gameid\")),day:\"7\",os:\"0\",page:1},total:0,games:[],sharePayResultTypesCC:[],creatives:[],clients:[],clientmap:[],creativemap:[],surveyManyLine:{},handelPayCount:[],key:\"all\",showcreative:!1,showclient:!1,showcc:!0}},methods:{init:function(){this.queryAllServer()},handleSearch:function(){this.queryAllServer()},queryAllServer:function(){var e=this;this.columnspro=JSON.parse(JSON.stringify(this.columns)),0!=this.searchForm.day&&1!=this.searchForm.day&&this.handleColumns(3),0==this.searchForm.os&&\"\"==this.searchForm.clientid&&null==this.searchForm.creative&&this.handleColumns(2),\"\"==this.searchForm.clientid&&this.handleColumns(1),null==this.searchForm.creative&&this.handleColumns(4),Object(n[\"Nb\"])(this.searchForm).then((function(t){if(t.success){e.data=t.msg,e.sharePayResultTypesCC=t.sharePayResultTypesCC,e.creatives=t.creatives,e.clients=t.clients,e.surveyManyLine.changeData(e.handelPayCount),e.creativemap=t.creatives.map((function(e){return{key:e.creativeid,name:e.creativeName}}));var a=new Object;a.key=\"0\",a.name=\"全渠道\",e.creativemap.unshift(a);var i=new Map;e.creativemap.forEach((function(e,t){i.set(e.key,e.name)})),e.clientmap=t.clients.map((function(e){return{key:e.serverid,name:e.serverName}}));var s=new Object;s.key=\"-1\",s.name=\"所有服\",e.clientmap.unshift(s);var n=new Map;e.clientmap.forEach((function(e,t){n.set(e.key,e.name)})),e.tableDataProcess(e.data,i,n),e.tableDataProcess(e.sharePayResultTypesCC,i,n),e.handelPayCount=e.makeCavas(e.data,e.searchForm.day),e.surveyManyLine.changeData(e.handelPayCount)}}))},showclients:function(e){\"all\"==e?(this.showcreative=!1,this.showclient=!1,this.showcc=!0,delete this.searchForm.creative,this.searchForm.clientid=\"\"):\"creative\"==e?(this.showcreative=!0,this.showclient=!1,this.showcc=!1,this.searchForm.creative=\"0\",this.searchForm.clientid=\"\"):(this.showcreative=!1,this.showclient=!0,this.showcc=!1,delete this.searchForm.creative,this.searchForm.clientid=\"-1\")},handleColumns:function(e){var t=this;this.columnspro.map((function(a,i){var s=a.checkAccess;s&&(s-Number(e)==0?t.columnspro.splice(i,1):console.log(i))}))},weekFunction:function(e){var t=new Date(e),a=t.getDay(),i=7-a;switch(i){case 7:e+=\"(七)\";break;case 1:e+=\"(六)\";break;case 2:e+=\"(五)\";break;case 3:e+=\"(四)\";break;case 4:e+=\"(三)\";break;case 5:e+=\"(二)\";break;case 6:e+=\"(一)\";break;default:}return e},surveyManyLineChart:function(){this.surveyManyLine=new G2.Chart({container:\"surveyManyLine\",forceFit:!0,height:500}),this.surveyManyLine.source(this.handelPayCount,{}),this.surveyManyLine.scale(\"value\",{min:0,alias:\"人数\"}),this.surveyManyLine.scale(\"time\",{tickCount:6}),this.surveyManyLine.tooltip({crosshairs:{type:\"line\"}}),this.surveyManyLine.axis(\"time\",{label:{rotate:-Math.PI/2.5,textAlign:\"end\",textBaseline:\"middle\"}}),this.surveyManyLine.axis(\"time\",{label:{formatter:function(e){return e}}}),this.surveyManyLine.legend({position:\"bottom\",align:\"center\",itemWidth:null}),this.surveyManyLine.line().position(\"time*value\").color(\"type\").shape(\"smooth\"),this.surveyManyLine.point().position(\"time*value\").color(\"type\").size(4).shape(\"circle\").style({stroke:\"#fff\",lineWidth:1}),this.surveyManyLine.render()},makeCavas:function(e,t){if(e){0==t&&e.sort((function(e,t){return t.dayOfHour-e.dayOfHour}));var a=[];return e.forEach((function(e,i){var s=new Object;s.time=7!=t&&30!=t?e.dayOfHour+\"时\":e.ds.substr(5,5),s.value=e.payCount,s.type=\"付费人数\",a.push(s);var n=new Object;n.time=7!=t&&30!=t?e.dayOfHour+\"时\":e.ds.substr(5,5),n.value=e.payAmount,n.type=\"付费金额\",a.push(n);var r=new Object;r.time=7!=t&&30!=t?e.dayOfHour+\"时\":e.ds.substr(5,5),r.value=e.payTimes,r.type=\"付费次数\",a.push(r);var l=new Object;l.time=7!=t&&30!=t?e.dayOfHour+\"时\":e.ds.substr(5,5),l.value=e.payInstallCount,l.type=\"安装付费人数\",a.push(l);var c=new Object;c.time=7!=t&&30!=t?e.dayOfHour+\"时\":e.ds.substr(5,5),c.value=e.payInstallAmount,c.type=\"安装付费金额\",a.push(c);var o=new Object;o.time=7!=t&&30!=t?e.dayOfHour+\"时\":e.ds.substr(5,5),o.value=e.payInstallTimes,o.type=\"安装付费次数\",a.push(o)})),7!=t&&30!=t&&0!=t||a.reverse(),a}},tableDataProcess:function(e,t,a){var i=this;return e&&e.forEach((function(e){e.ds=i.weekFunction(e.ds),e.client=void 0===a.get(String(e.clientid))?e.client:a.get(String(e.clientid)),e.creative=void 0===t.get(e.creative)?e.creative:t.get(e.creative),e.payRate=0==e.dauNum?0:(100*e.payCount/e.dauNum).toFixed(2)+\"%\",e.ARPPU=0==e.payCount?0:(e.payAmount/e.payCount).toFixed(2),e.payInstallRate=0==e.installNum?0:(100*e.payInstallCount/e.installNum).toFixed(2)+\"%\",e.payInstallARPU=0==e.installNum?0:(e.payInstallAmount/e.installNum).toFixed(2),e.payInstallARPPU=0==e.payInstallCount?0:(e.payInstallAmount/e.payInstallCount).toFixed(2),e.payAmount=e.payAmount/i.getStore(\"currencyRate\"),e.payInstallAmount=e.payInstallAmount/i.getStore(\"currencyRate\")})),e}},mounted:function(){this.init(),this.surveyManyLineChart()}},l=r,c=a(\"2877\"),o=Object(c[\"a\"])(l,i,s,!1,null,\"1c22180c\",null);t[\"default\"]=o.exports}}]);","extractedComments":[]}