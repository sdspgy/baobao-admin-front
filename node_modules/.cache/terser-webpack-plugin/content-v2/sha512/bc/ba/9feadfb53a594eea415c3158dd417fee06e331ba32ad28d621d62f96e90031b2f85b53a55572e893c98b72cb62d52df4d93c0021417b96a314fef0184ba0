{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-43efed01\"],{\"3f27\":function(e,t,l){\"use strict\";l.d(t,\"a\",(function(){return a}));var a=function(e){var t=new Date(e),l=t.getDay(),a=7-l;switch(a){case 7:e+=\"(七)\";break;case 1:e+=\"(六)\";break;case 2:e+=\"(五)\";break;case 3:e+=\"(四)\";break;case 4:e+=\"(三)\";break;case 5:e+=\"(二)\";break;case 6:e+=\"(一)\";break;default:}return e}},cccc:function(e,t,l){\"use strict\";l.r(t);var a=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l(\"div\",[l(\"div\",[l(\"RadioGroup\",{on:{\"on-change\":function(t){return e.init()}},model:{value:e.phone,callback:function(t){e.phone=t},expression:\"phone\"}},[l(\"Radio\",{attrs:{label:\"0\"}},[l(\"Icon\",{attrs:{type:\"logo-windows\"}}),l(\"span\",[e._v(\"ALL\")])],1),l(\"Radio\",{attrs:{label:\"1\"}},[l(\"Icon\",{attrs:{type:\"logo-android\"}}),l(\"span\",[e._v(\"ANDROID\")])],1),l(\"Radio\",{attrs:{label:\"2\"}},[l(\"Icon\",{attrs:{type:\"logo-apple\"}}),l(\"span\",[e._v(\"IOS\")])],1)],1)],1),l(\"div\",[l(\"RadioGroup\",{attrs:{type:\"button\",size:\"large\"},on:{\"on-change\":function(t){return e.init()}},model:{value:e.data,callback:function(t){e.data=t},expression:\"data\"}},[l(\"Radio\",{attrs:{label:\"1\"}},[e._v(\"昨天\")]),l(\"Radio\",{attrs:{label:\"7\"}},[e._v(\"7日\")]),l(\"Radio\",{attrs:{label:\"30\"}},[e._v(\"30日\")])],1)],1),l(\"Form\",{ref:\"from\",attrs:{model:e.reportLevelForm,\"label-width\":80}},[l(\"FormItem\",{attrs:{label:\"\",prop:\"value\"}},[l(\"Select\",{staticStyle:{width:\"200px\"},on:{\"on-change\":function(t){return e.changeType()}},model:{value:e.reportLevelForm.index,callback:function(t){e.$set(e.reportLevelForm,\"index\",t)},expression:\"reportLevelForm.index\"}},e._l(e.option_levelType,(function(t){return l(\"Option\",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.text)+\"\\n                \")])})),1)],1)],1),l(\"Row\",[l(\"Table\",{ref:\"table\",attrs:{height:\"300\",\"highlight-row\":\"\",border:\"\",columns:e.columsLevel,data:e.dauLevelData}})],1),l(\"div\",{attrs:{id:\"levelChart\"}}),l(\"Row\",[l(\"Table\",{ref:\"table\",attrs:{height:\"300\",\"highlight-row\":\"\",border:\"\",columns:e.columsLevelSum,data:e.dauLevelDataSum}})],1)],1)},n=[],r=l(\"365c\"),o=l(\"3f27\"),i={name:\"reportLevel\",data:function(){return{defaultPhone:{all:0,android:1,ios:2},defaultData:{yestoday:1,week:7,month:30},phone:\"0\",data:\"7\",option_levelType:[{text:\"活跃等级分布\",value:0},{text:\"注册等级分布\",value:1},{text:\"付费等级分布\",value:2},{text:\"新付费等级分布\",value:3},{text:\"新注册付费等级分布\",value:4}],levelType:{dau_level:0,install_level:1,pay_level:2,new_pay_level:3,pay_install_level:4},reportLevelForm:{index:0},columnsHeadr:[{title:\"日期（星期）\",key:\"ds\",width:150,fixed:\"left\"}],columsOs:[{title:\"操作系统\",key:\"os\",width:150,fixed:\"left\"}],columsLevel:[],columsLevelSum:[],dauLevelData:[],dauLevelDataSum:[],chartArr:[],levelG2:{}}},methods:{init:function(){this.queryLevel()},changeType:function(){this.queryLevel()},queryLevel:function(){var e=this,t={gameid:parseInt(this.getStore(\"gameid\")),date:parseInt(this.data),levelType:parseInt(this.reportLevelForm.index),os:this.phone};Object(r[\"Rb\"])(t).then((function(t){if(t.success){var l=t.levelDau,a=t.levelDauSum;l&&a&&function(){var t=0,n=Object.keys(l).sort((function(e,t){return e<t?1:e>t?-1:0}));if(Object.keys(l).length>0&&Object.keys(a).length>0){var r=n[0],i=l[r];t=i[i.length-1].level}for(var s=[],u=1;u<=t;u++){var v=new Object;v.title=u+\"级\",v.key=u+\"level\",v.width=150,s.push(v)}var c=[],d=[],m=function(a){var n={};n.ds=Object(o[\"a\"])(l[a][0].ds),n.os=Object(o[\"a\"])(l[a][0].os);for(var r=1;r<=t;r++)n[r+\"level\"]=0;l[a].forEach((function(t){e.reportLevelForm.index==e.levelType.dau_level?n[t.level+\"level\"]=0==t.dauNum?0:(t.dauLevelNumbers/t.dauNum*100).toFixed(2):e.reportLevelForm.index==e.levelType.install_level?n[t.level+\"level\"]=0==t.installNum?0:(t.installLevelNumbers/t.installNum*100).toFixed(2):e.reportLevelForm.index==e.levelType.pay_level?n[t.level+\"level\"]=0==t.payCount?0:(t.payLevelNumbers/t.payCount*100).toFixed(2):e.reportLevelForm.index==e.levelType.new_pay_level?n[t.level+\"level\"]=0==t.newPayCount?0:(t.newPayLevelNumbers/t.newPayCount*100).toFixed(2):e.reportLevelForm.index==e.levelType.pay_install_level&&(n[t.level+\"level\"]=0==t.payInstallCount?0:(t.payInstallLevelNumbers/t.payInstallCount*100).toFixed(2))})),c.push(n)};for(var p in l)m(p);for(var h=Math.ceil(t/10),f=[],b=[],y=1;y<=h;y++){var L=new Object;L[10*y+\"level\"]=10*y-9+\"~\"+10*y+\"级\",L.title=10*y-9+\"~\"+10*y+\"级\",L.key=10*y+\"level\",L.width=150,b.push(L)}var x=function(e){var t={};t.ds=Object(o[\"a\"])(a[e][0].ds),t.os=Object(o[\"a\"])(a[e][0].os),a[e].forEach((function(l,a){var n=new Object;n.name=10*(a+1)-9+\"~\"+10*(a+1)+\"级\",n.time=e.substr(5,5),t[10*(a+1)+\"level\"]=0==l.dauNum?0:(l.dauLevelNumbers/l.dauNum*100).toFixed(2),n.value=0==l.dauNum?0:parseFloat((l.dauLevelNumbers/l.dauNum*100).toFixed(2)),f.push(n)})),d.push(t)};for(var w in a)x(w);f.sort((function(e,t){return e.time<t.time?-1:e.time>t.time?1:0})),c.sort((function(e,t){var l=e.ds,a=t.ds;return l<a?1:l>a?-1:0})),d.sort((function(e,t){var l=e.ds,a=t.ds;return l<a?1:l>a?-1:0})),e.phone==e.defaultPhone.android||e.phone==e.defaultPhone.ios?(e.columsLevel=e.columnsHeadr.concat(e.columsOs).concat(s),e.columsLevelSum=e.columnsHeadr.concat(e.columsOs).concat(b)):(e.columsLevel=e.columnsHeadr.concat(s),e.columsLevelSum=e.columnsHeadr.concat(b)),e.dauLevelData=c,e.dauLevelDataSum=d,e.chartArr=f}(),e.levelG2.changeData(e.chartArr)}}))},levelCharts:function(){this.levelG2=new G2.Chart({container:\"levelChart\",forceFit:!0,height:500}),this.levelG2.source(this.chartArr,{value:{min:0,formatter:function(e){return e+\"%\"}}}),this.levelG2.axis(\"time\",{label:{rotate:-Math.PI/2.5,textAlign:\"end\",textBaseline:\"middle\"}}),this.levelG2.intervalStack().position(\"time*value\").color(\"name\").adjust(\"stack\").shape(\"text\"),this.levelG2.render()},compares:function(e,t){var l=e.ds,a=t.ds;return l<a?1:l>a?-1:0}},mounted:function(){this.levelCharts(),this.init()}},s=i,u=l(\"2877\"),v=Object(u[\"a\"])(s,a,n,!1,null,\"b4353b98\",null);t[\"default\"]=v.exports}}]);","extractedComments":[]}