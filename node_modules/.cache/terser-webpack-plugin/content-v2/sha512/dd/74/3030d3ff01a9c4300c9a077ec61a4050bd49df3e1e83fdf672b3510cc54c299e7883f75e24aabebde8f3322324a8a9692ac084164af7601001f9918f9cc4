{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-b84ee066\"],{\"3f27\":function(e,t,i){\"use strict\";i.d(t,\"a\",(function(){return n}));var n=function(e){var t=new Date(e),i=t.getDay(),n=7-i;switch(n){case 7:e+=\"(七)\";break;case 1:e+=\"(六)\";break;case 2:e+=\"(五)\";break;case 3:e+=\"(四)\";break;case 4:e+=\"(三)\";break;case 5:e+=\"(二)\";break;case 6:e+=\"(一)\";break;default:}return e}},\"476d\":function(e,t,i){\"use strict\";var n=i(\"8ee4\"),a=i.n(n);a.a},\"8ee4\":function(e,t,i){},d088:function(e,t,i){\"use strict\";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"div\",[i(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.isShow,expression:\"isShow\"}]},[i(\"RadioGroup\",{on:{\"on-change\":function(t){return e.init()}},model:{value:e.isDevice,callback:function(t){e.isDevice=t},expression:\"isDevice\"}},[i(\"Radio\",{attrs:{label:\"0\"}},[e._v(\"用户\")]),i(\"Radio\",{attrs:{label:\"1\"}},[e._v(\"设备\")])],1)],1),i(\"div\",[i(\"RadioGroup\",{on:{\"on-change\":function(t){return e.init()}},model:{value:e.phone,callback:function(t){e.phone=t},expression:\"phone\"}},[i(\"Radio\",{attrs:{label:\"0\"}},[i(\"Icon\",{attrs:{type:\"logo-windows\"}}),i(\"span\",[e._v(\"ALL\")])],1),i(\"Radio\",{attrs:{label:\"1\"}},[i(\"Icon\",{attrs:{type:\"logo-android\"}}),i(\"span\",[e._v(\"ANDROID\")])],1),i(\"Radio\",{attrs:{label:\"2\"}},[i(\"Icon\",{attrs:{type:\"logo-apple\"}}),i(\"span\",[e._v(\"IOS\")])],1),i(\"Radio\",{attrs:{label:\"3\"}},[i(\"Icon\",{attrs:{type:\"ios-bookmark\"}}),i(\"span\",[e._v(\"NONE\")])],1)],1)],1),i(\"div\",[i(\"RadioGroup\",{attrs:{type:\"button\",size:\"large\"},on:{\"on-change\":function(t){return e.init()}},model:{value:e.data,callback:function(t){e.data=t},expression:\"data\"}},[i(\"Radio\",{attrs:{label:\"0\"}},[e._v(\"今天\")]),i(\"Radio\",{attrs:{label:\"1\"}},[e._v(\"昨天\")]),i(\"Radio\",{attrs:{label:\"7\"}},[e._v(\"7日\")]),i(\"Radio\",{attrs:{label:\"30\"}},[e._v(\"30日\")])],1)],1),i(\"div\",[i(\"RadioGroup\",{on:{\"on-change\":function(t){return e.creativeOrClientChange()}},model:{value:e.creativeOrClient,callback:function(t){e.creativeOrClient=t},expression:\"creativeOrClient\"}},[i(\"Radio\",{attrs:{label:\"2\"}},[e._v(\"概况\")]),i(\"Radio\",{attrs:{label:\"0\"}},[e._v(\"渠道\")]),i(\"Radio\",{attrs:{label:\"1\"}},[e._v(\"分服\")])],1)],1),i(\"Form\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.showCreativeOrClient,expression:\"showCreativeOrClient\"}],ref:\"from\",attrs:{model:e.reportRetentionForm,\"label-width\":80}},[i(\"FormItem\",{attrs:{label:\"\",prop:\"key\"}},[i(\"Select\",{staticStyle:{width:\"200px\"},on:{\"on-change\":function(t){return e.changeCreativeOrClient()}},model:{value:e.reportRetentionForm.index,callback:function(t){e.$set(e.reportRetentionForm,\"index\",t)},expression:\"reportRetentionForm.index\"}},e._l(e.creativeOrClients,(function(t){return i(\"Option\",{key:t.key,attrs:{value:t.key}},[e._v(e._s(t.name)+\"\\n                \")])})),1)],1)],1),i(\"div\",[e._v(e._s(e.retentionTitle))]),i(\"div\",{attrs:{id:\"reportLine\"}}),i(\"Row\",[i(\"Table\",{ref:\"table\",attrs:{height:\"300\",\"highlight-row\":\"\",\"row-class-name\":e.retentionListClass,border:\"\",columns:e.columns,data:e.retentionList},on:{\"on-row-click\":e.clickRetention}})],1),i(\"Row\",[i(\"Table\",{ref:\"table\",attrs:{height:\"300\",\"highlight-row\":\"\",border:\"\",columns:e.payColumns,data:e.payRentenTable}})],1),i(\"Row\",[i(\"Table\",{ref:\"table\",attrs:{height:\"300\",\"highlight-row\":\"\",border:\"\",columns:e.payColumns,data:e.payInstallRetenTable}})],1)],1)},a=[],r=i(\"365c\"),o=i(\"3f27\"),s={name:\"reportRetention\",data:function(){return{isShow:!0,defaultIsDeviceDef:{user:0,device:1},defaultPhone:{all:0,android:1,ios:2,none:3},defaultData:{today:0,yestoday:1,week:7,month:30},defaultCreativeOrClient:{survey:2,creative:0,client:1},isDevice:\"0\",phone:\"0\",data:\"7\",creativeOrClient:\"2\",isOs:0,indexStatu:2,index:\"0\",reportRetentionForm:{index:\"0\"},showCreativeOrClient:!0,creativeOrClients:[],columns:[],payColumns:[],columnsHeadr:[{title:\"日期（星期）\",key:\"ds\",width:150,fixed:\"left\"}],columnsReal:[{title:\"～时\",key:\"dayOfHour\",width:150,fixed:\"left\"}],columsOs:[{title:\"操作系统\",key:\"os\",width:150,fixed:\"left\"}],columsCreative:[{title:\"渠道\",key:\"creative\",width:150,fixed:\"left\"}],columsClient:[{title:\"分服\",key:\"client\",width:150,fixed:\"left\"}],retentionTable:[{title:\"1日\",key:\"oneRetentionPercentage\",width:150},{title:\"2日\",key:\"twoRetentionPercentage\",width:150},{title:\"3日\",key:\"threeRetentionPercentage\",width:150},{title:\"4日\",key:\"fourRetentionPercentage\",width:150},{title:\"5日\",key:\"fiveRetentionPercentage\",width:150},{title:\"6日\",key:\"sixRetentionPercentage\",width:150},{title:\"7日\",key:\"sevenRetentionPercentage\",width:150},{title:\"8日\",key:\"eightRetentionPercentage\",width:150},{title:\"9日\",key:\"nineRetentionPercentage\",width:150},{title:\"10日\",key:\"tenRetentionPercentage\",width:150},{title:\"11日\",key:\"elevenRetentionPercentage\",width:150},{title:\"12日\",key:\"twelveRetentionPercentage\",width:150},{title:\"13日\",key:\"thirteenRetentionPercentage\",width:150},{title:\"14日\",key:\"fourteenRetentionPercentage\",width:150},{title:\"15日\",key:\"fifteenRetentionPercentage\",width:150},{title:\"16日\",key:\"sixteenRetentionPercentage\",width:150},{title:\"17日\",key:\"seventeenRetentionPercentage\",width:150},{title:\"18日\",key:\"eighteenRetentionPercentage\",width:150},{title:\"19日\",key:\"nineteenRetentionPercentage\",width:150},{title:\"20日\",key:\"twentyteenRetentionPercentage\",width:150},{title:\"21日\",key:\"twentyOneteenRetentionPercentage\",width:150},{title:\"22日\",key:\"twentyTwoRetentionPercentage\",width:150},{title:\"23日\",key:\"twentyThreeRetentionPercentage\",width:150},{title:\"24日\",key:\"twentyFourRetentionPercentage\",width:150},{title:\"25日\",key:\"twentyFiveRetentionPercentage\",width:150},{title:\"26日\",key:\"twentySixRetentionPercentage\",width:150},{title:\"27日\",key:\"twentySevenRetentionPercentage\",width:150},{title:\"28日\",key:\"twentyEightRetentionPercentage\",width:150},{title:\"29日\",key:\"twentyNineRetentionPercentage\",width:150},{title:\"30日\",key:\"thirtyRetentionPercentage\",width:150}],payRenDayTitles:[{title:\"1日\",key:\"1day\",width:150},{title:\"2日\",key:\"2day\",width:150},{title:\"3日\",key:\"3day\",width:150},{title:\"4日\",key:\"4day\",width:150},{title:\"5日\",key:\"5day\",width:150},{title:\"6日\",key:\"6day\",width:150},{title:\"7日\",key:\"7day\",width:150},{title:\"8日\",key:\"8day\",width:150},{title:\"9日\",key:\"9day\",width:150},{title:\"10日\",key:\"10day\",width:150},{title:\"11日\",key:\"11day\",width:150},{title:\"12日\",key:\"12day\",width:150},{title:\"13日\",key:\"13day\",width:150},{title:\"14日\",key:\"14day\",width:150},{title:\"15日\",key:\"15day\",width:150},{title:\"16日\",key:\"16day\",width:150},{title:\"17日\",key:\"17day\",width:150},{title:\"18日\",key:\"18day\",width:150},{title:\"19日\",key:\"19day\",width:150},{title:\"20日\",key:\"20day\",width:150},{title:\"21日\",key:\"21day\",width:150},{title:\"22日\",key:\"22day\",width:150},{title:\"23日\",key:\"23day\",width:150},{title:\"24日\",key:\"24day\",width:150},{title:\"25日\",key:\"25day\",width:150},{title:\"26日\",key:\"26day\",width:150},{title:\"27日\",key:\"27day\",width:150},{title:\"28日\",key:\"28day\",width:150},{title:\"29日\",key:\"29day\",width:150},{title:\"30日\",key:\"30day\",width:150}],retentionList:[],payRentenTable:[],handelRetentionOne:[],surveyOneLine:{},arrayCreate:[],creatives:[],creativeMap:[],arrayClient:[],clients:[],clientMap:[],payInstallRetenTable:[],retentionTitle:\"\"}},methods:{init:function(){0==this.getStore(\"parentId\")?this.isShow=!0:this.isShow=!1,parseInt(this.creativeOrClient)==this.defaultCreativeOrClient.creative||parseInt(this.creativeOrClient)==this.defaultCreativeOrClient.client?this.showCreativeOrClient=!0:this.showCreativeOrClient=!1,this.phone==this.defaultPhone.none?this.isOs=1:this.isOs=0;var e=this.columnsHeadr,t=[];this.phone==this.defaultPhone.none||this.phone==this.defaultPhone.all&&this.creativeOrClient==this.defaultCreativeOrClient.survey||(e=e.concat(this.columsOs)),this.data!=this.defaultData.today&&this.data!=this.defaultData.yestoday||(e=e.concat(this.columnsReal)),this.indexStatu=2,this.creativeOrClient==this.defaultCreativeOrClient.client&&(e=e.concat(this.columsClient),this.indexStatu=1),this.creativeOrClient==this.defaultCreativeOrClient.creative&&(e=e.concat(this.columsCreative),this.indexStatu=0),t=e,t=t.concat(this.payRenDayTitles),e=e.concat(this.retentionTable),this.columns=e,this.payColumns=t,this.queryRetention()},queryRetention:function(){var e=this,t={gameid:parseInt(this.getStore(\"gameid\")),deviceType:this.isDevice,osType:this.phone,isOs:this.isOs,data:this.data,ccType:this.indexStatu,ccNum:this.reportRetentionForm.index,page:1};1==this.indexStatu&&(t.ccNum=this.reportRetentionForm.index),0==this.indexStatu&&(t.ccNum=this.reportRetentionForm.index),Object(r[\"Vb\"])(t).then((function(t){if(t.success){var i=[];i=e.saturday(t.shareRetentionList);var n=new Map;t.creatives.forEach((function(e,t){n.set(e.creativeid,e.creativeName)}));var a=t.clients.map((function(e){return{key:e.serverid,name:e.serverName}})),r=new Object;r.key=\"-1\",r.name=\"所有服\",a.unshift(r);var o=new Map;a.forEach((function(e,t){o.set(e.key,e.name)})),i.forEach((function(e){e.creative=void 0===n.get(e.creative)?e.creative:n.get(e.creative),e.client=void 0===o.get(String(e.clientid))?e.client:o.get(String(e.clientid))}));var s=e.makeRetentionOne(i[5]);e.retentionList=i,e.handelRetentionOne=s,e.surveyOneLine.changeData(s)}}));var i={gameid:parseInt(this.getStore(\"gameid\")),date:parseInt(this.data),device:parseInt(this.isDevice)!=this.defaultIsDeviceDef.user};this.phone!=this.defaultPhone.none&&(i.os=this.phone),this.indexStatu==this.defaultCreativeOrClient.client&&(i.clientid=this.reportRetentionForm.index,this.creativeOrClients=this.clients),this.indexStatu==this.defaultCreativeOrClient.creative&&(i.creative=this.reportRetentionForm.index,this.creativeOrClients=this.creatives),Object(r[\"Tb\"])(i).then((function(t){if(t.success){var i=t.sharePayRetentionMap,n=t.shareInstallPayRetentionMap,a=t.creatives.map((function(e){return{key:e.creativeid,name:e.creativeName}})),r=t.clients.map((function(e){return{key:e.serverid,name:e.serverName}})),s=[];s.push(\"全渠道\"),t.creatives.forEach((function(e){s.push(e.creativeName)}));var l=new Object;l.key=\"0\",l.name=\"全渠道\",a.unshift(l);var c=new Map;a.forEach((function(e,t){c.set(e.key,e.name)}));var h=[];h.push(\"所有服\"),t.clients.forEach((function(e){h.push(e.serverName)}));var d=new Object;d.key=\"0\",d.name=\"所有服\",r.unshift(d);var u=new Map;if(r.forEach((function(e,t){u.set(e.key,e.name)})),e.arrayCreate=s,e.creatives=a,e.creativeMap=c,e.arrayClient=h,e.clients=r,e.clientMap=u,n){var v=[],y=function(e){var t={};t.ds=Object(o[\"a\"])(n[e][0].ds),t.os=n[e][0].os,t.creative=void 0===c.get(n[e][0].creative)?n[e][0].creative:c.get(n[e][0].creative),t.client=u.get(String(n[e][0].clientid));for(var i=1;i<=30;i++)t[i+\"day\"]=0;n[e].forEach((function(e){t[e.dr+\"day\"]=0==e.payInstallCount?0:(e.retention/e.payInstallCount*100).toFixed(2)})),v.push(t)};for(var p in n)y(p);v.sort(e.compare),e.payInstallRetenTable=v}if(i){var w=[],f=function(e){var t={};t.ds=Object(o[\"a\"])(i[e][0].ds),t.os=i[e][0].os,t.creative=void 0===c.get(i[e][0].creative)?i[e][0].creative:c.get(i[e][0].creative),t.client=u.get(String(i[e][0].clientid));for(var n=1;n<=30;n++)t[n+\"day\"]=0;i[e].forEach((function(e){t[e.dr+\"day\"]=0==e.payCount?0:(e.retention/e.payCount*100).toFixed(2)})),w.push(t)};for(var R in i)f(R);w.sort(e.compare),e.payRentenTable=w}}}))},creativeOrClientChange:function(){this.reportRetentionForm.index=\"0\",this.init()},changeCreativeOrClient:function(){this.init()},clickRetention:function(e){this.retentionTitle=e.ds,this.surveyOneLine.changeData(this.makeRetentionOne(e))},makeRetentionOne:function(e){var t=[];if(e){var i=new Object;i.time=1,i.value=parseFloat(e.oneRetentionPercentage),t.push(i);var n=new Object;n.time=2,n.value=parseFloat(e.twoRetentionPercentage),t.push(n);var a=new Object;a.time=3,a.value=parseFloat(e.threeRetentionPercentage),t.push(a);var r=new Object;r.time=4,r.value=parseFloat(e.fourRetentionPercentage),t.push(r);var o=new Object;o.time=5,o.value=parseFloat(e.fiveRetentionPercentage),t.push(o);var s=new Object;s.time=6,s.value=parseFloat(e.sixRetentionPercentage),t.push(s);var l=new Object;l.time=7,l.value=parseFloat(e.sevenRetentionPercentage),t.push(l);var c=new Object;c.time=8,c.value=parseFloat(e.eightRetentionPercentage),t.push(c);var h=new Object;h.time=9,h.value=parseFloat(e.nineRetentionPercentage),t.push(h);var d=new Object;d.time=10,d.value=parseFloat(e.tenRetentionPercentage),t.push(d);var u=new Object;u.time=11,u.value=parseFloat(e.elevenRetentionPercentage),t.push(u);var v=new Object;v.time=12,v.value=parseFloat(e.twelveRetentionPercentage),t.push(v);var y=new Object;y.time=13,y.value=parseFloat(e.thirteenRetentionPercentage),t.push(y);var p=new Object;p.time=14,p.value=parseFloat(e.fourteenRetentionPercentage),t.push(p);var w=new Object;w.time=15,w.value=parseFloat(e.fifteenRetentionPercentage),t.push(w)}return t},reportLineChart:function(){this.surveyOneLine=new G2.Chart({container:\"reportLine\",forceFit:!0,height:500}),this.surveyOneLine.source(this.handelRetentionOne,{}),this.surveyOneLine.scale(\"value\",{min:0,alias:\"留存率\"}),this.surveyOneLine.scale(\"time\",{tickCount:6}),this.surveyOneLine.tooltip({crosshairs:{type:\"line\"}}),this.surveyOneLine.axis(\"time\",{label:{rotate:-Math.PI/2.5,textAlign:\"end\",textBaseline:\"middle\"}}),this.surveyOneLine.line().position(\"time*value\").shape(\"smooth\").color(\"l(0) 0:#F2C587 0.5:#ED7973 1:#8659AF\"),this.surveyOneLine.point().position(\"time*value\").size(4).shape(\"circle\").style({stroke:\"#fff\",lineWidth:1}).color(\"l(0) 0:#F2C587 0.5:#ED7973 1:#8659AF\"),this.surveyOneLine.area().position(\"time*value\").shape(\"smooth\").color(\"l(0) 0:#F2C587 0.5:#ED7973 1:#8659AF\"),this.surveyOneLine.render()},saturday:function(e){if(e)return e.forEach((function(e,t){var i=new Date(e.ds),n=i.getDay(),a=7-n,r=[];switch(a){case 7:r=[\"oneRetentionPercentage\",\"eightRetentionPercentage\",\"fifteenRetentionPercentage\"];break;case 1:r=[\"sevenRetentionPercentage\",\"fourteenRetentionPercentage\"];break;case 2:r=[\"sixRetentionPercentage\",\"thirteenRetentionPercentage\"];break;case 3:r=[\"fiveRetentionPercentage\",\"twelveRetentionPercentage\"];break;case 4:r=[\"fourRetentionPercentage\",\"elevenRetentionPercentage\"];break;case 5:r=[\"threeRetentionPercentage\",\"tenRetentionPercentage\"];break;case 6:r=[\"twoRetentionPercentage\",\"nineRetentionPercentage\"];break;default:}e.special=r,e.oneSpecial=r[0],e.twoSpecial=r[1],e.ds=Object(o[\"a\"])(e.ds)})),e},compare:function(e,t){var i=e.ds,n=t.ds;return i<n?1:i>n?-1:0},retentionListClass:function(e,t){}},mounted:function(){this.reportLineChart(),this.init()}},l=s,c=(i(\"476d\"),i(\"2877\")),h=Object(c[\"a\"])(l,n,a,!1,null,\"794f493f\",null);t[\"default\"]=h.exports}}]);","extractedComments":[]}