{"remainingRequest":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/src/views/reportdata/reportAdd/reportAdd.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/src/views/reportdata/reportAdd/reportAdd.vue","mtime":1586260681793},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {queryAllPayReq} from '@/api/index';\nimport vTitleHead from '../../game/template/TitleHead';\n\nexport default {\n    name: 'pay',\n    components: {vTitleHead},\n    comments: {},\n    data() {\n        return {\n            loadingAdd:true,\n            isShow: true,\n            installTable: '新增数据',\n            installTables: '新增数据(Android/iOS)',\n            installChart: '新增趋势',\n            columnspro: [],\n            columns: [\n                {\n                    title: '日期(星期)',\n                    key: 'ds',\n                    align: 'center',\n                    width: 150\n                    // sortable: true\n                },\n                {\n                    title: '操作系统',\n                    key: 'os',\n                    width: 100,\n                    align: 'center',\n                    checkAccess: [2]\n                    // sortable: true,\n                    // fixed: 'left'\n                },\n                {\n                    title: '小时',\n                    key: 'dayOfHour',\n                    width: 100,\n                    checkAccess: [3]\n                    //   render:(h,params)=>{\n                    //       return h('div', { style: {\n                    //               display:(params.row.dayOfHour==0)?\"none\":\"inline-block\",\n                    //               color: '#FF7D41'\n                    //       }\n                    //       },params.row.dayOfHour);\n                    // },\n                    // sortable: true\n                },\n                {\n                    title: '渠道',\n                    key: 'creative',\n                    width: 100,\n                    align: 'center',\n                    checkAccess: [4]\n                    // sortable: true\n                },\n                {\n                    title: '服',\n                    key: 'clientid',\n                    width: 100,\n                    align: 'center',\n                    checkAccess: [1]\n                    // sortable: true\n                },\n                {\n                    title: '注册数',\n                    key: 'installNum',\n                    align: 'center',\n                    width: 80\n                },\n                {\n                    title: '新付费率（%）',\n                    key: 'payInstallRate',\n                    align: 'center',\n                    width: 130\n                },\n                {\n                    title: '新付费ARPU',\n                    key: 'payInstallARPU',\n                    align: 'center',\n                    width: 120\n                },\n                {\n                    title: '新付费ARPPU',\n                    key: 'payInstallARPPU',\n                    align: 'center',\n                    width: 120\n                },\n                {\n                    title: '新付费人数',\n                    key: 'payInstallCount',\n                    align: 'center',\n                    width: 100\n                },\n                {\n                    title: '新付费总额',\n                    key: 'payInstallAmount',\n                    align: 'center',\n                    width: 100\n                },\n                {\n                    title: '新付费次数',\n                    key: 'payInstallTimes',\n                    // align: 'center',\n                    // width: 100\n                },\n                // {\n                // \ttitle: '创建时间',\n                // \tkey: 'createTime',\n                // \tsortable: true,\n                // \tsortType: 'desc',\n                // \twidth: 150\n                // },\n            ],\n            columnscc: [\n                {\n                    title: '日期(星期)',\n                    key: 'ds',\n                    align: 'center',\n                    width: 120\n                },\n                {\n                    title: '操作系统',\n                    key: 'os',\n                    align: 'center',\n                    width: 100\n                },\n                {\n                    title: '注册数',\n                    key: 'installNum',\n                    align: 'center',\n                    width: 80\n                },\n                {\n                    title: '新付费率（%）',\n                    key: 'payInstallRate',\n                    align: 'center',\n                    width: 130\n                },\n                {\n                    title: '新付费ARPU',\n                    key: 'payInstallARPU',\n                    align: 'center',\n                    width: 120\n                },\n                {\n                    title: '新付费ARPPU',\n                    key: 'payInstallARPPU',\n                    align: 'center',\n                    width: 120\n                },\n                {\n                    title: '新付费人数',\n                    key: 'payInstallCount',\n                    align: 'center',\n                    width: 100\n                },\n                {\n                    title: '新付费总额',\n                    key: 'payInstallAmount',\n                    align: 'center',\n                    width: 100\n                },\n                {\n                    title: '新付费次数',\n                    key: 'payInstallTimes',\n                    // width: 150\n                    // sortable: true\n                },\n            ],\n            data: [],\n            searchForm: {\n                source: '0',\n                creativeid: '',\n                clientid: '',\n                gameid: parseInt(this.getStore('gameid')),\n                day: '7',\n                os: '0',\n                page: 1\n            },\n            total: 0,\n            games: [],\n            sharePayResultTypesCC: [],\n            creatives: [],\n            clients: [],\n            clientmap: [],\n            creativemap: [],\n            surveyOneLine: {},\n            datas: [],\n            key: 'all',\n            showcreative: false,\n            showclient: false,\n            showcc: true\n        };\n    },\n    methods: {\n        init() {\n            this.loadingAdd = true;\n            if (this.getStore('parentId') == 0) {\n                this.isShow = true\n            } else {\n                this.isShow = false\n            }\n            this.queryAllServer();\n        },\n        handleSearch() {\n            this.queryAllServer();\n        },\n        queryAllServer() {\n            this.columnspro = JSON.parse(JSON.stringify(this.columns));\n            if (this.searchForm.day != 0 && this.searchForm.day != 1) {\n                this.handleColumns(3)\n            }\n            if (this.searchForm.os == 0 && this.searchForm.clientid == '' && this.searchForm.creative == null) {\n                this.handleColumns(2)\n            }\n            if (this.searchForm.clientid == '') {\n                this.handleColumns(1)\n            }\n            if (this.searchForm.creative == null) {\n                this.handleColumns(4)\n            }\n            queryAllPayReq(this.searchForm).then(res => {\n                this.loadingAdd = false;\n                if (res.success) {\n                    this.sharePayResultTypesCC = res.sharePayResultTypesCC;\n                    this.creatives = res.creatives;\n                    this.clients = res.clients;\n                    //\n                    this.creativemap = (res.creatives).map(item => ({\n                        key: item.creativeid,\n                        name: item.creativeName,\n                    }));\n                    let allObject = new Object();\n                    allObject.key = '0';\n                    allObject.name = '全渠道';\n                    this.creativemap.unshift(allObject);\n                    let creativeMap = new Map();\n                    this.creativemap.forEach((item, index) => {\n                        creativeMap.set(item.key, item.name)\n                    })\n                    //\n                    this.clientmap = (res.clients).map(item => ({\n                        key: item.serverid,\n                        name: item.serverName,\n                    }));\n                    let allObject2 = new Object();\n                    allObject2.key = '-1'\n                    allObject2.name = '所有服'\n                    this.clientmap.unshift(allObject2);\n                    let clientMap = new Map();\n                    this.clientmap.forEach((item, indx) => {\n                        clientMap.set(item.key, item.name)\n                    })\n\n                    this.data = this.tableDataProcess(res.msg, creativeMap, clientMap);\n                    this.sharePayResultTypesCC = this.tableDataProcess(res.sharePayResultTypesCC, creativeMap, clientMap);\n\n                    let datac = [];\n                    this.data.forEach(item => {\n                        datac.push(item.installNum);\n                    });\n                    this.datas = this.f2DI(datac, this.searchForm.day, this.data, 0);\n                    this.surveyOneLine.changeData(this.datas);\n\n                }\n            });\n        },\n        showclients(val) {\n            if (this.key == 'all') {\n                this.showcreative = false;\n                this.showclient = false;\n                this.showcc = true;\n                delete this.searchForm.creative;\n                this.searchForm.clientid = '';\n                this.init()\n            } else if (this.key == 'creative') {\n                this.showcreative = true;\n                this.showclient = false;\n                this.showcc = false;\n                this.searchForm.creative = '0';\n                this.searchForm.clientid = '';\n                this.init()\n            } else {\n                this.showcreative = false;\n                this.showclient = true;\n                this.showcc = false;\n                delete this.searchForm.creative;\n                this.searchForm.clientid = '-1';\n                this.init()\n            }\n        },\n        handleColumns(access) {\n            this.columnspro.map((item, index) => {\n                let checkAccess = item.checkAccess\n                if (checkAccess) {\n                    if (checkAccess - Number(access) == 0) {\n                        this.columnspro.splice(index, 1)\n                    } else {\n                        console.log(index)\n                    }\n                }\n            })\n        },\n        weekFunction: function (ds) {\n            let week = new Date(ds);\n            let dateweek = week.getDay();\n            let i = 7 - dateweek;\n            switch (i) {\n                case 7:\n                    ds = ds + \"(七)\";\n                    break\n                case 1:\n                    ds = ds + \"(六)\";\n                    break\n                case 2:\n                    ds = ds + \"(五)\";\n                    break\n                case 3:\n                    ds = ds + \"(四)\";\n                    break\n                case 4:\n                    ds = ds + \"(三)\";\n                    break\n                case 5:\n                    ds = ds + \"(二)\";\n                    break\n                case 6:\n                    ds = ds + \"(一)\";\n                    break\n                default:\n            }\n            return ds;\n        },\n        surveyOneLineChart() {\n            /*---------------------单折线图-------------------*/\n            this.surveyOneLine = new G2.Chart({\n                container: 'surveyOneLine',\n                forceFit: true,\n                height: 300\n            });\n            this.surveyOneLine.source(this.datas, {});\n            this.surveyOneLine.scale('value', {\n                min: 0,\n                alias: '人数',\n            });\n            this.surveyOneLine.scale('time', {\n                // range: [0, 1]\n                tickCount: 9,\n            });\n            this.surveyOneLine.tooltip({\n                crosshairs: {\n                    type: 'line'\n                }\n            });\n            // 坐标轴文本旋转\n            this.surveyOneLine.axis('time', {\n                label: {\n                    rotate: -Math.PI / 4,\n                    textAlign: 'end',\n                    textBaseline: 'middle'\n                }\n            });\n            this.surveyOneLine.line().position('time*value').shape('smooth');\n            this.surveyOneLine.point().position('time*value')\n                .size(4)\n                .shape('circle')\n                .style({\n                    stroke: '#fff',\n                    lineWidth: 1\n                })\n                .color('l(0) 0:#1E90FF 0.5:#1E90FF 1:#1E90FF');\n            this.surveyOneLine.area().position('time*value').shape('smooth');\n            this.surveyOneLine.render();\n            // return this.surveyOneLine;\n        },\n        f2DI: function (data, date, listData, type) {\n            let datas = [];\n            if (date == 0 || date == 1) {\n                listData.forEach(info => {\n                    let item = new Object();\n                    if (type == 0) {\n                        item.value = info.dauNum;\n                    } else {\n                        item.value = info.installNum;\n                    }\n                    item.time = info.dayOfHour + '时';\n                    datas.push(item);\n                });\n            } else {\n                listData.forEach((item, index) => {\n                    let info = new Object();\n                    info.time = (item.ds).substr(5, 5);\n                    info.value = item.installNum;\n                    datas.push(info);\n                });\n            }\n            if (date == \"7\" || date == \"30\" || date == \"0\") {\n                //该方法会改变原来的数组，而不会创建新的数组\n                datas.reverse();\n            }\n            return datas;\n        },\n        getTime: function (index) {\n            let myDate = new Date();\n            myDate.setTime(myDate.getTime() - 24 * 60 * 60 * 1000 * (index + 1));\n            let dateTime = (myDate.getMonth() + 1) + \"-\" + myDate.getDate();\n            return dateTime;\n        },\n        tableDataProcess(data, creativeMap, clientMap) {\n            if (data) {\n                data.forEach((item) => {\n                    item.ds = this.weekFunction(item.ds);\n                    item.client = clientMap.get(String(item.clientid)) === undefined ? item.client : clientMap.get(String(item.clientid));\n                    item.creative = creativeMap.get(item.creative) === undefined ? item.creative : creativeMap.get(item.creative);\n                    item.payInstallRate = item.installNum == 0 ? 0 : (item.payInstallCount * 100 / item.installNum).toFixed(2);\n                    item.payInstallARPU = item.installNum == 0 ? 0 : (item.payInstallAmount / item.installNum).toFixed(2);\n                    item.payInstallARPPU = item.payInstallCount == 0 ? 0 : (item.payInstallAmount / item.payInstallCount).toFixed(2);\n                    item.payInstallAmount = item.payInstallAmount / this.getStore(\"currencyRate\");\n\n                })\n            }\n            return data;\n        },\n    },\n    mounted() {\n        this.init();\n        this.surveyOneLineChart();\n    }\n}\n",{"version":3,"sources":["reportAdd.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgFA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"reportAdd.vue","sourceRoot":"src/views/reportdata/reportAdd","sourcesContent":["<template>\n    <div style=\"background-color:#fff;\">\n        <!--        <div style=\"position: absolute;background-color:#fff;border-radius: 10px 10px 10px 10px;width: 30%;height: 450px;line-height: 50px\">-->\n        <div>\n            <div v-show=\"isShow\">\n                <RadioGroup v-model=\"searchForm.source\" type=\"button\" @on-change=\"init()\">\n                    <Radio style=\"margin: 10px 10px\" label=\"0\">用户</Radio>\n                    <Radio style=\"margin: 10px 10px\" label=\"1\">设备</Radio>\n                </RadioGroup>\n            </div>\n            <div>\n                <RadioGroup v-model=\"searchForm.os\" type=\"button\" @on-change=\"init()\">\n                    <Radio style=\"margin: 10px 10px\" label=\"0\">\n                        <span>ALL</span>\n                    </Radio>\n                    <Radio style=\"margin: 10px 10px\" label=\"1\">\n                        <span>ANDROID</span>\n                    </Radio>\n                    <Radio style=\"margin: 10px 10px\" label=\"2\">\n                        <span>IOS</span>\n                    </Radio>\n                    <Radio style=\"margin: 10px 10px\" label=\"-1\">\n                        <span>NONE</span>\n                    </Radio>\n                </RadioGroup>\n            </div>\n            <div>\n                <RadioGroup v-model=\"searchForm.day\" type=\"button\" @on-change=\"init()\">>\n                    <Radio style=\"margin: 10px 10px\" label=\"0\">今天</Radio>\n                    <Radio style=\"margin: 10px 10px\" label=\"1\">昨天</Radio>\n                    <Radio style=\"margin: 10px 10px\" label=\"7\">7天</Radio>\n                    <Radio style=\"margin: 10px 10px\" label=\"30\">30天</Radio>\n                </RadioGroup>\n            </div>\n            <div>\n                <RadioGroup v-model=\"key\" type=\"button\" @on-change=\"showclients(key)\">>\n                    <Radio style=\"margin: 10px 10px\" label=\"all\">概况</Radio>\n                    <Radio style=\"margin: 10px 10px\" label=\"creative\">渠道</Radio>\n                    <Radio style=\"margin: 10px 10px\" label=\"client\">分服</Radio>\n                </RadioGroup>\n            </div>\n            <Form ref=\"searchForm\" :model=\"searchForm\" inline :label-width=\"70\" class=\"search-form\">\n                <Form-item label=\"\" prop=\"creative\" v-if=\"showcreative\">\n                    <Select @on-change=\"init()\" v-model=\"searchForm.creative\" style=\"width:200px\">\n                        <Option v-for=\"item in creativemap\" :value=\"item.key\" :key=\"item.key\">{{ item.name}}</Option>\n                    </Select>\n                </Form-item>\n                <Form-item label=\"\" prop=\"client\" v-if=\"showclient\">\n                    <Select @on-change=\"init()\" v-model=\"searchForm.clientid\" style=\"width:200px\">\n                        <Option v-for=\"item in clientmap\" :value=\"item.key\" :key=\"item.key\">{{ item.name }}</Option>\n                    </Select>\n                </Form-item>\n            </Form>\n        </div>\n\n        <div>\n            <vTitleHead :inputName=\"installChart\"></vTitleHead>\n            <div style=\"background-color:#fff;border-radius: 0 0 10px 10px\" id=\"surveyOneLine\"></div>\n        </div>\n\n        <div style=\"margin-top: 20px\">\n            <vTitleHead :inputName=\"installTable\"></vTitleHead>\n            <Row>\n                <Table  height=\"405\" :loading=\"loadingAdd\" border :columns=\"columnspro\" :data=\"data\" sortable=\"custom\"\n                       ref=\"table\"></Table>\n            </Row>\n        </div>\n\n        <div v-if=\"showcc\" style=\"margin-top: 20px\">\n            <vTitleHead :inputName=\"installTables\"></vTitleHead>\n            <Row>\n                <Table height=\"405\" highlight-row border :columns=\"columnscc\" :data=\"sharePayResultTypesCC\"\n                       ref=\"table\"></Table>\n            </Row>\n        </div>\n\n    </div>\n</template>\n\n<script>\n    import {queryAllPayReq} from '@/api/index';\n    import vTitleHead from '../../game/template/TitleHead';\n\n    export default {\n        name: 'pay',\n        components: {vTitleHead},\n        comments: {},\n        data() {\n            return {\n                loadingAdd:true,\n                isShow: true,\n                installTable: '新增数据',\n                installTables: '新增数据(Android/iOS)',\n                installChart: '新增趋势',\n                columnspro: [],\n                columns: [\n                    {\n                        title: '日期(星期)',\n                        key: 'ds',\n                        align: 'center',\n                        width: 150\n                        // sortable: true\n                    },\n                    {\n                        title: '操作系统',\n                        key: 'os',\n                        width: 100,\n                        align: 'center',\n                        checkAccess: [2]\n                        // sortable: true,\n                        // fixed: 'left'\n                    },\n                    {\n                        title: '小时',\n                        key: 'dayOfHour',\n                        width: 100,\n                        checkAccess: [3]\n                        //   render:(h,params)=>{\n                        //       return h('div', { style: {\n                        //               display:(params.row.dayOfHour==0)?\"none\":\"inline-block\",\n                        //               color: '#FF7D41'\n                        //       }\n                        //       },params.row.dayOfHour);\n                        // },\n                        // sortable: true\n                    },\n                    {\n                        title: '渠道',\n                        key: 'creative',\n                        width: 100,\n                        align: 'center',\n                        checkAccess: [4]\n                        // sortable: true\n                    },\n                    {\n                        title: '服',\n                        key: 'clientid',\n                        width: 100,\n                        align: 'center',\n                        checkAccess: [1]\n                        // sortable: true\n                    },\n                    {\n                        title: '注册数',\n                        key: 'installNum',\n                        align: 'center',\n                        width: 80\n                    },\n                    {\n                        title: '新付费率（%）',\n                        key: 'payInstallRate',\n                        align: 'center',\n                        width: 130\n                    },\n                    {\n                        title: '新付费ARPU',\n                        key: 'payInstallARPU',\n                        align: 'center',\n                        width: 120\n                    },\n                    {\n                        title: '新付费ARPPU',\n                        key: 'payInstallARPPU',\n                        align: 'center',\n                        width: 120\n                    },\n                    {\n                        title: '新付费人数',\n                        key: 'payInstallCount',\n                        align: 'center',\n                        width: 100\n                    },\n                    {\n                        title: '新付费总额',\n                        key: 'payInstallAmount',\n                        align: 'center',\n                        width: 100\n                    },\n                    {\n                        title: '新付费次数',\n                        key: 'payInstallTimes',\n                        // align: 'center',\n                        // width: 100\n                    },\n                    // {\n                    // \ttitle: '创建时间',\n                    // \tkey: 'createTime',\n                    // \tsortable: true,\n                    // \tsortType: 'desc',\n                    // \twidth: 150\n                    // },\n                ],\n                columnscc: [\n                    {\n                        title: '日期(星期)',\n                        key: 'ds',\n                        align: 'center',\n                        width: 120\n                    },\n                    {\n                        title: '操作系统',\n                        key: 'os',\n                        align: 'center',\n                        width: 100\n                    },\n                    {\n                        title: '注册数',\n                        key: 'installNum',\n                        align: 'center',\n                        width: 80\n                    },\n                    {\n                        title: '新付费率（%）',\n                        key: 'payInstallRate',\n                        align: 'center',\n                        width: 130\n                    },\n                    {\n                        title: '新付费ARPU',\n                        key: 'payInstallARPU',\n                        align: 'center',\n                        width: 120\n                    },\n                    {\n                        title: '新付费ARPPU',\n                        key: 'payInstallARPPU',\n                        align: 'center',\n                        width: 120\n                    },\n                    {\n                        title: '新付费人数',\n                        key: 'payInstallCount',\n                        align: 'center',\n                        width: 100\n                    },\n                    {\n                        title: '新付费总额',\n                        key: 'payInstallAmount',\n                        align: 'center',\n                        width: 100\n                    },\n                    {\n                        title: '新付费次数',\n                        key: 'payInstallTimes',\n                        // width: 150\n                        // sortable: true\n                    },\n                ],\n                data: [],\n                searchForm: {\n                    source: '0',\n                    creativeid: '',\n                    clientid: '',\n                    gameid: parseInt(this.getStore('gameid')),\n                    day: '7',\n                    os: '0',\n                    page: 1\n                },\n                total: 0,\n                games: [],\n                sharePayResultTypesCC: [],\n                creatives: [],\n                clients: [],\n                clientmap: [],\n                creativemap: [],\n                surveyOneLine: {},\n                datas: [],\n                key: 'all',\n                showcreative: false,\n                showclient: false,\n                showcc: true\n            };\n        },\n        methods: {\n            init() {\n                this.loadingAdd = true;\n                if (this.getStore('parentId') == 0) {\n                    this.isShow = true\n                } else {\n                    this.isShow = false\n                }\n                this.queryAllServer();\n            },\n            handleSearch() {\n                this.queryAllServer();\n            },\n            queryAllServer() {\n                this.columnspro = JSON.parse(JSON.stringify(this.columns));\n                if (this.searchForm.day != 0 && this.searchForm.day != 1) {\n                    this.handleColumns(3)\n                }\n                if (this.searchForm.os == 0 && this.searchForm.clientid == '' && this.searchForm.creative == null) {\n                    this.handleColumns(2)\n                }\n                if (this.searchForm.clientid == '') {\n                    this.handleColumns(1)\n                }\n                if (this.searchForm.creative == null) {\n                    this.handleColumns(4)\n                }\n                queryAllPayReq(this.searchForm).then(res => {\n                    this.loadingAdd = false;\n                    if (res.success) {\n                        this.sharePayResultTypesCC = res.sharePayResultTypesCC;\n                        this.creatives = res.creatives;\n                        this.clients = res.clients;\n                        //\n                        this.creativemap = (res.creatives).map(item => ({\n                            key: item.creativeid,\n                            name: item.creativeName,\n                        }));\n                        let allObject = new Object();\n                        allObject.key = '0';\n                        allObject.name = '全渠道';\n                        this.creativemap.unshift(allObject);\n                        let creativeMap = new Map();\n                        this.creativemap.forEach((item, index) => {\n                            creativeMap.set(item.key, item.name)\n                        })\n                        //\n                        this.clientmap = (res.clients).map(item => ({\n                            key: item.serverid,\n                            name: item.serverName,\n                        }));\n                        let allObject2 = new Object();\n                        allObject2.key = '-1'\n                        allObject2.name = '所有服'\n                        this.clientmap.unshift(allObject2);\n                        let clientMap = new Map();\n                        this.clientmap.forEach((item, indx) => {\n                            clientMap.set(item.key, item.name)\n                        })\n\n                        this.data = this.tableDataProcess(res.msg, creativeMap, clientMap);\n                        this.sharePayResultTypesCC = this.tableDataProcess(res.sharePayResultTypesCC, creativeMap, clientMap);\n\n                        let datac = [];\n                        this.data.forEach(item => {\n                            datac.push(item.installNum);\n                        });\n                        this.datas = this.f2DI(datac, this.searchForm.day, this.data, 0);\n                        this.surveyOneLine.changeData(this.datas);\n\n                    }\n                });\n            },\n            showclients(val) {\n                if (this.key == 'all') {\n                    this.showcreative = false;\n                    this.showclient = false;\n                    this.showcc = true;\n                    delete this.searchForm.creative;\n                    this.searchForm.clientid = '';\n                    this.init()\n                } else if (this.key == 'creative') {\n                    this.showcreative = true;\n                    this.showclient = false;\n                    this.showcc = false;\n                    this.searchForm.creative = '0';\n                    this.searchForm.clientid = '';\n                    this.init()\n                } else {\n                    this.showcreative = false;\n                    this.showclient = true;\n                    this.showcc = false;\n                    delete this.searchForm.creative;\n                    this.searchForm.clientid = '-1';\n                    this.init()\n                }\n            },\n            handleColumns(access) {\n                this.columnspro.map((item, index) => {\n                    let checkAccess = item.checkAccess\n                    if (checkAccess) {\n                        if (checkAccess - Number(access) == 0) {\n                            this.columnspro.splice(index, 1)\n                        } else {\n                            console.log(index)\n                        }\n                    }\n                })\n            },\n            weekFunction: function (ds) {\n                let week = new Date(ds);\n                let dateweek = week.getDay();\n                let i = 7 - dateweek;\n                switch (i) {\n                    case 7:\n                        ds = ds + \"(七)\";\n                        break\n                    case 1:\n                        ds = ds + \"(六)\";\n                        break\n                    case 2:\n                        ds = ds + \"(五)\";\n                        break\n                    case 3:\n                        ds = ds + \"(四)\";\n                        break\n                    case 4:\n                        ds = ds + \"(三)\";\n                        break\n                    case 5:\n                        ds = ds + \"(二)\";\n                        break\n                    case 6:\n                        ds = ds + \"(一)\";\n                        break\n                    default:\n                }\n                return ds;\n            },\n            surveyOneLineChart() {\n                /*---------------------单折线图-------------------*/\n                this.surveyOneLine = new G2.Chart({\n                    container: 'surveyOneLine',\n                    forceFit: true,\n                    height: 300\n                });\n                this.surveyOneLine.source(this.datas, {});\n                this.surveyOneLine.scale('value', {\n                    min: 0,\n                    alias: '人数',\n                });\n                this.surveyOneLine.scale('time', {\n                    // range: [0, 1]\n                    tickCount: 9,\n                });\n                this.surveyOneLine.tooltip({\n                    crosshairs: {\n                        type: 'line'\n                    }\n                });\n                // 坐标轴文本旋转\n                this.surveyOneLine.axis('time', {\n                    label: {\n                        rotate: -Math.PI / 4,\n                        textAlign: 'end',\n                        textBaseline: 'middle'\n                    }\n                });\n                this.surveyOneLine.line().position('time*value').shape('smooth');\n                this.surveyOneLine.point().position('time*value')\n                    .size(4)\n                    .shape('circle')\n                    .style({\n                        stroke: '#fff',\n                        lineWidth: 1\n                    })\n                    .color('l(0) 0:#1E90FF 0.5:#1E90FF 1:#1E90FF');\n                this.surveyOneLine.area().position('time*value').shape('smooth');\n                this.surveyOneLine.render();\n                // return this.surveyOneLine;\n            },\n            f2DI: function (data, date, listData, type) {\n                let datas = [];\n                if (date == 0 || date == 1) {\n                    listData.forEach(info => {\n                        let item = new Object();\n                        if (type == 0) {\n                            item.value = info.dauNum;\n                        } else {\n                            item.value = info.installNum;\n                        }\n                        item.time = info.dayOfHour + '时';\n                        datas.push(item);\n                    });\n                } else {\n                    listData.forEach((item, index) => {\n                        let info = new Object();\n                        info.time = (item.ds).substr(5, 5);\n                        info.value = item.installNum;\n                        datas.push(info);\n                    });\n                }\n                if (date == \"7\" || date == \"30\" || date == \"0\") {\n                    //该方法会改变原来的数组，而不会创建新的数组\n                    datas.reverse();\n                }\n                return datas;\n            },\n            getTime: function (index) {\n                let myDate = new Date();\n                myDate.setTime(myDate.getTime() - 24 * 60 * 60 * 1000 * (index + 1));\n                let dateTime = (myDate.getMonth() + 1) + \"-\" + myDate.getDate();\n                return dateTime;\n            },\n            tableDataProcess(data, creativeMap, clientMap) {\n                if (data) {\n                    data.forEach((item) => {\n                        item.ds = this.weekFunction(item.ds);\n                        item.client = clientMap.get(String(item.clientid)) === undefined ? item.client : clientMap.get(String(item.clientid));\n                        item.creative = creativeMap.get(item.creative) === undefined ? item.creative : creativeMap.get(item.creative);\n                        item.payInstallRate = item.installNum == 0 ? 0 : (item.payInstallCount * 100 / item.installNum).toFixed(2);\n                        item.payInstallARPU = item.installNum == 0 ? 0 : (item.payInstallAmount / item.installNum).toFixed(2);\n                        item.payInstallARPPU = item.payInstallCount == 0 ? 0 : (item.payInstallAmount / item.payInstallCount).toFixed(2);\n                        item.payInstallAmount = item.payInstallAmount / this.getStore(\"currencyRate\");\n\n                    })\n                }\n                return data;\n            },\n        },\n        mounted() {\n            this.init();\n            this.surveyOneLineChart();\n        }\n    }\n</script>\n\n<style scoped>\n\n</style>\n"]}]}