{"remainingRequest":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/thread-loader/dist/cjs.js!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/babel-loader/lib/index.js!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/src/views/game/client/client.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/src/views/game/client/client.vue","mtime":1585037797985},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { queryAllClientReq, addClient, editClient, deleteClient } from '@/api/index';\nexport default {\n  name: 'gameServer',\n  comments: {},\n  data: function data() {\n    var _this = this;\n\n    return {\n      columns: [{\n        type: 'selection',\n        width: 60,\n        align: 'center',\n        fixed: 'left'\n      }, // {\n      // \ttype: 'expand',\n      // \twidth: 50,\n      // \tfixed: 'left',\n      // \trender: (h, params) => {\n      // \t\treturn h(expandRow, {\n      // \t\t\tprops: {\n      // \t\t\t\trow: params.row\n      // \t\t\t}\n      // \t\t});\n      // \t}\n      // },\n      {\n        type: 'index',\n        width: 60,\n        align: 'center',\n        fixed: 'left'\n      }, {\n        title: '游戏名',\n        key: 'gameName',\n        width: 150 // sortable: true,\n        // fixed: 'left'\n\n      }, {\n        title: '分服码',\n        key: 'serverid',\n        width: 150 // sortable: true\n\n      }, {\n        title: '分服名称',\n        key: 'serverName',\n        width: 150 // sortable: true\n\n      }, // {\n      // \ttitle: '创建时间',\n      // \tkey: 'createTime',\n      // \tsortable: true,\n      // \tsortType: 'desc',\n      // \twidth: 150\n      // },\n      {\n        title: '操作',\n        key: 'action',\n        width: 200,\n        align: 'center',\n        // fixed: 'right',\n        render: function render(h, params) {\n          var enableOrDisable = '';\n          var editButton = h('Button', {\n            props: {\n              type: 'primary',\n              size: 'small',\n              disabled: !_this.$route.meta.permTypes.includes('edit')\n            },\n            style: {\n              marginRight: '5px'\n            },\n            on: {\n              click: function click() {\n                _this.edit(params.row);\n              }\n            }\n          }, '编辑');\n          var deleteButton = h('Button', {\n            props: {\n              type: 'error',\n              size: 'small',\n              disabled: !_this.$route.meta.permTypes.includes('delete')\n            },\n            on: {\n              click: function click() {\n                _this.remove(params.row);\n              }\n            }\n          }, '删除');\n          return h('div', [editButton, deleteButton]);\n        }\n      }],\n      data: [],\n      searchForm: {\n        gameid: '',\n        serverid: '',\n        pageNumber: 1,\n        pageSize: 10\n      },\n      total: 0,\n      submitLoading: false,\n      serverModalVisible: false,\n      serverForm: {\n        id: '',\n        gameid: '',\n        serverid: '',\n        serverName: ''\n      },\n      games: []\n    };\n  },\n  methods: {\n    init: function init() {\n      this.queryAllServer();\n    },\n    handleSearch: function handleSearch() {\n      this.queryAllServer();\n    },\n    queryAllServer: function queryAllServer() {\n      var _this2 = this;\n\n      queryAllClientReq(this.searchForm).then(function (res) {\n        // this.loading = false;\n        if (res.success) {\n          var data = res.result[1].records;\n          _this2.games = res.result[0].records;\n\n          for (var info in data) {\n            for (var item in _this2.games) {\n              if (_this2.games[item].gameid == data[info].gameid) {\n                data[info].gameName = _this2.games[item].name;\n                break;\n              }\n            }\n          }\n\n          _this2.data = data;\n          _this2.total = res.result.total;\n        }\n      });\n    },\n    changePage: function changePage(v) {\n      this.searchForm.pageNumber = v;\n      this.queryAllServer();\n      this.clearSelectAll();\n    },\n    changePageSize: function changePageSize(v) {\n      this.searchForm.pageSize = v;\n      this.queryAllServer();\n    },\n    clearSelectAll: function clearSelectAll() {\n      this.$refs.table.selectAll(false);\n    },\n    submitServer: function submitServer() {\n      var _this3 = this;\n\n      debugger;\n      this.$refs.serverForm.validate(function (valid) {\n        if (valid) {\n          if (_this3.modalType == 0) {\n            // 添加 避免编辑后传入id\n            delete _this3.serverForm.id;\n\n            if (_this3.serverForm.serverid == '' || _this3.serverForm.serverid == undefined) {\n              _this3.errorServerid = '分服码不能为空';\n              return;\n            }\n\n            if (_this3.serverForm.serverName == '' || _this3.serverForm.serverName == undefined) {\n              _this3.errorServerName = '分服名称不能为空';\n              return;\n            }\n\n            _this3.submitLoading = true;\n            addClient({\n              gameid: _this3.serverForm.gameid,\n              serverid: _this3.serverForm.serverid,\n              serverName: _this3.serverForm.serverName\n            }).then(function (res) {\n              _this3.submitLoading = false;\n\n              if (res.success) {\n                _this3.$Message.success('操作成功');\n\n                _this3.queryAllServer();\n\n                _this3.serverModalVisible = false;\n              }\n            });\n          } else {\n            // 编辑\n            _this3.submitLoading = true;\n            editClient({\n              id: _this3.serverForm.id,\n              gameid: _this3.serverForm.gameid,\n              serverid: _this3.serverForm.serverid,\n              serverName: _this3.serverForm.serverName\n            }).then(function (res) {\n              _this3.submitLoading = false;\n\n              if (res.success) {\n                _this3.$Message.success('操作成功');\n\n                _this3.queryAllServer();\n\n                _this3.serverModalVisible = false;\n              }\n            });\n          }\n        }\n      });\n    },\n    cancelAdvert: function cancelAdvert() {\n      this.serverModalVisible = false;\n    },\n    add: function add() {\n      this.modalType = 0;\n      this.modalTitle = '添加分服';\n      this.$refs.serverForm.resetFields();\n      this.serverModalVisible = true;\n    },\n    edit: function edit(v) {\n      this.modalType = 1;\n      this.modalTitle = '编辑分服';\n      this.$refs.serverForm.resetFields(); // 转换null为\"\"\n\n      for (var attr in v) {\n        if (v[attr] == null) {\n          v[attr] = '';\n        }\n      }\n\n      var str = JSON.stringify(v);\n      var data = JSON.parse(str);\n      this.serverForm = data;\n      this.serverModalVisible = true;\n    },\n    remove: function remove(v) {\n      var _this4 = this;\n\n      this.$Modal.confirm({\n        title: '确认删除',\n        content: '您确认要删除分服名为： ' + v.serverName + '?',\n        loading: true,\n        onOk: function onOk() {\n          deleteClient(v.id).then(function (res) {\n            _this4.$Modal.remove();\n\n            if (res.success) {\n              _this4.$Message.success('删除成功');\n\n              _this4.queryAllServer();\n            }\n          });\n        }\n      });\n    }\n  },\n  mounted: function mounted() {\n    this.init();\n  }\n};",null]}