{"remainingRequest":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/thread-loader/dist/cjs.js!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/babel-loader/lib/index.js!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/src/views/reportdata/reportRetention/reportRetention.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/src/views/reportdata/reportRetention/reportRetention.vue","mtime":1587108759720},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hoolai/Documents/tyz/workspace-ws/baobao-admin-front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { queryRetention as _queryRetention, queryPayRetention } from '@/api/index';\nimport { weekChange } from '@/libs/changeWeek';\nimport vTitleHead from '../../game/template/TitleHead';\nexport default {\n  name: \"reportRetention\",\n  components: {\n    vTitleHead: vTitleHead\n  },\n  data: function data() {\n    return {\n      loadRetention: true,\n      isretentionLine: true,\n      isShowCondition: false,\n      isShow: true,\n      defaultIsDeviceDef: {\n        user: 0,\n        device: 1\n      },\n      defaultPhone: {\n        all: 0,\n        android: 1,\n        ios: 2,\n        none: 3\n      },\n      defaultData: {\n        today: 0,\n        yestoday: 1,\n        week: 7,\n        month: 30\n      },\n      defaultCreativeOrClient: {\n        survey: 2,\n        creative: 0,\n        client: 1\n      },\n      isDevice: \"0\",\n      phone: \"0\",\n      data: \"7\",\n      creativeOrClient: \"2\",\n      isOs: 0,\n      indexStatu: 2,\n      index: \"0\",\n      reportRetentionForm: {\n        index: \"0\"\n      },\n      showCreativeOrClient: true,\n      creativeOrClients: [],\n      columns: [],\n      payColumns: [],\n      columnsHeadr: [{\n        title: '日期（星期）',\n        key: 'ds',\n        width: 150,\n        align: 'center',\n        fixed: 'left'\n      }],\n      columnsReal: [{\n        title: '～时',\n        key: 'dayOfHour',\n        width: 150,\n        align: 'center',\n        fixed: 'left'\n      }],\n      columsOs: [{\n        title: '操作系统',\n        key: 'os',\n        width: 120,\n        align: 'center',\n        fixed: 'left'\n      }],\n      columsCreative: [{\n        title: '渠道',\n        key: 'creative',\n        width: 100,\n        align: 'center',\n        fixed: 'left'\n      }],\n      columsClient: [{\n        title: '分服',\n        key: 'client',\n        width: 100,\n        align: 'center',\n        fixed: 'left'\n      }],\n      retentionTable: [{\n        title: '注册数',\n        key: 'installNum',\n        align: 'center',\n        width: 80\n      }, {\n        title: '1日',\n        key: 'oneRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '2日',\n        key: 'twoRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '3日',\n        key: 'threeRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '4日',\n        key: 'fourRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '5日',\n        key: 'fiveRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '6日',\n        key: 'sixRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '7日',\n        key: 'sevenRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '8日',\n        key: 'eightRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '9日',\n        key: 'nineRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '10日',\n        key: 'tenRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '11日',\n        key: 'elevenRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '12日',\n        key: 'twelveRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '13日',\n        key: 'thirteenRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '14日',\n        key: 'fourteenRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '15日',\n        key: 'fifteenRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '16日',\n        key: 'sixteenRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '17日',\n        key: 'seventeenRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '18日',\n        key: 'eighteenRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '19日',\n        key: 'nineteenRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '20日',\n        key: 'twentyteenRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '21日',\n        key: 'twentyOneteenRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '22日',\n        key: 'twentyTwoRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '23日',\n        key: 'twentyThreeRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '24日',\n        key: 'twentyFourRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '25日',\n        key: 'twentyFiveRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '26日',\n        key: 'twentySixRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '27日',\n        key: 'twentySevenRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '28日',\n        key: 'twentyEightRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '29日',\n        key: 'twentyNineRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '30日',\n        key: 'thirtyRetentionPercentage',\n        width: 80,\n        align: 'center'\n      }],\n      payRenDayTitles: [{\n        title: '付费人数',\n        key: 'payCount',\n        width: 100,\n        align: 'center'\n      }, {\n        title: '付费率',\n        key: 'pays',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '1日',\n        key: '1day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '2日',\n        key: '2day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '3日',\n        key: '3day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '4日',\n        key: '4day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '5日',\n        key: '5day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '6日',\n        key: '6day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '7日',\n        key: '7day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '8日',\n        key: '8day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '9日',\n        key: '9day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '10日',\n        key: '10day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '11日',\n        key: '11day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '12日',\n        key: '12day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '13日',\n        key: '13day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '14日',\n        key: '14day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '15日',\n        key: '15day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '16日',\n        key: '16day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '17日',\n        key: '17day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '18日',\n        key: '18day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '19日',\n        key: '19day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '20日',\n        key: '20day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '21日',\n        key: '21day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '22日',\n        key: '22day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '23日',\n        key: '23day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '24日',\n        key: '24day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '25日',\n        key: '25day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '26日',\n        key: '26day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '27日',\n        key: '27day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '28日',\n        key: '28day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '29日',\n        key: '29day',\n        width: 80,\n        align: 'center'\n      }, {\n        title: '30日',\n        key: '30day',\n        width: 80,\n        align: 'center'\n      }],\n      retentionList: [],\n      payRentenTable: [],\n      handelRetentionOne: [],\n      surveyOneLine: {},\n      retentionLine: {},\n      arrayCreate: [],\n      creatives: [],\n      creativeMap: [],\n      arrayClient: [],\n      clients: [],\n      clientMap: [],\n      payInstallRetenTable: [],\n      retentionTitle: '',\n      retentionsTitle: '留存平均值',\n      retentionAverage: [],\n      installPayRetentionTableTitle: '注册付费留存(%)',\n      retentionTableTitle: '留存数据(%)',\n      payRetentionTableTitle: '付费留存(%)'\n    };\n  },\n  methods: {\n    enter: function enter() {\n      this.isShowCondition = true;\n    },\n    leave: function leave() {\n      this.isShowCondition = false;\n    },\n    init: function init() {\n      this.loadRetention = true;\n\n      if (this.getStore('parentId') == 0) {\n        this.isShow = true;\n      } else {\n        this.isShow = false;\n      } // show渠道/服选择器\n\n\n      if (parseInt(this.creativeOrClient) == this.defaultCreativeOrClient.creative || parseInt(this.creativeOrClient) == this.defaultCreativeOrClient.client) {\n        this.showCreativeOrClient = true;\n      } else {\n        this.showCreativeOrClient = false;\n      }\n\n      if (this.creativeOrClient == \"2\") {\n        this.isretentionLine = true;\n      } else {\n        this.isretentionLine = false;\n      }\n\n      if (this.phone == this.defaultPhone.none) {\n        this.isOs = 1;\n      } else {\n        this.isOs = 0;\n      } // 处理表头\n\n\n      var colum = this.columnsHeadr;\n      var payColum = [];\n\n      if (this.phone != this.defaultPhone.none && !(this.phone == this.defaultPhone.all && this.creativeOrClient == this.defaultCreativeOrClient.survey)) {\n        colum = colum.concat(this.columsOs);\n      }\n\n      if (this.data == this.defaultData.today || this.data == this.defaultData.yestoday) {\n        colum = colum.concat(this.columnsReal);\n      }\n\n      this.indexStatu = 2;\n\n      if (this.creativeOrClient == this.defaultCreativeOrClient.client) {\n        colum = colum.concat(this.columsClient);\n        this.indexStatu = 1;\n      }\n\n      if (this.creativeOrClient == this.defaultCreativeOrClient.creative) {\n        colum = colum.concat(this.columsCreative);\n        this.indexStatu = 0;\n      }\n\n      payColum = colum;\n      payColum = payColum.concat(this.payRenDayTitles);\n      colum = colum.concat(this.retentionTable);\n      this.columns = colum;\n      this.payColumns = payColum;\n      this.queryRetention();\n    },\n    queryRetention: function queryRetention() {\n      var _this = this;\n\n      var params = {\n        gameid: parseInt(this.getStore('gameid')),\n        deviceType: this.isDevice,\n        osType: this.phone,\n        isOs: this.isOs,\n        data: this.data,\n        ccType: this.indexStatu,\n        ccNum: this.reportRetentionForm.index,\n        page: 1\n      };\n\n      if (this.indexStatu == 1) {\n        params.ccNum = this.reportRetentionForm.index;\n      }\n\n      if (this.indexStatu == 0) {\n        params.ccNum = this.reportRetentionForm.index;\n      }\n\n      _queryRetention(params).then(function (e) {\n        _this.loadRetention = false;\n\n        if (e.success) {\n          var retentionList = [];\n          retentionList = _this.saturday(e.shareRetentionList); //放入Map,creativeid为key\n\n          var creativeMap = new Map();\n          e.creatives.forEach(function (item, index) {\n            creativeMap.set(item.creativeid, item.creativeName);\n          });\n          var clients = e.clients.map(function (item) {\n            return {\n              key: item.serverid,\n              name: item.serverName\n            };\n          });\n          var object = new Object();\n          object.key = '-1';\n          object.name = '所有服';\n          clients.unshift(object);\n          var clientMap = new Map();\n          clients.forEach(function (item, index) {\n            clientMap.set(item.key, item.name);\n          });\n          retentionList.forEach(function (item) {\n            item.creative = creativeMap.get(item.creative) === undefined ? item.creative : creativeMap.get(item.creative);\n            item.client = clientMap.get(String(item.clientid)) === undefined ? item.client : clientMap.get(String(item.clientid));\n          });\n\n          var handelRetentionOne = _this.makeRetentionOne(retentionList[0]);\n\n          _this.retentionList = retentionList;\n          _this.handelRetentionOne = handelRetentionOne;\n          _this.retentionTitle = retentionList[0].ds + '留存趋势';\n\n          _this.surveyOneLine.changeData(handelRetentionOne);\n\n          _this.retentionLine.changeData(_this.retentionAverage);\n        }\n      });\n\n      var payRentenData = {\n        gameid: parseInt(this.getStore('gameid')),\n        date: parseInt(this.data),\n        device: parseInt(this.isDevice) == this.defaultIsDeviceDef.user ? false : true\n      };\n\n      if (this.phone != this.defaultPhone.none) {\n        payRentenData.os = this.phone;\n      }\n\n      if (this.indexStatu == this.defaultCreativeOrClient.client) {\n        payRentenData.clientid = this.reportRetentionForm.index;\n        this.creativeOrClients = this.clients;\n      }\n\n      if (this.indexStatu == this.defaultCreativeOrClient.creative) {\n        payRentenData.creative = this.reportRetentionForm.index;\n        this.creativeOrClients = this.creatives;\n      }\n\n      queryPayRetention(payRentenData).then(function (e) {\n        if (e.success) {\n          var payReten = e.sharePayRetentionMap;\n          var installPayReten = e.shareInstallPayRetentionMap;\n          /**\n           * 渠道信息\n           * @param creativeMap 替换表格数据\n           * @param creativeNames 替换选择头\n           */\n\n          var creatives = e.creatives.map(function (item) {\n            return {\n              key: item.creativeid,\n              name: item.creativeName\n            };\n          });\n          var clients = e.clients.map(function (item) {\n            return {\n              key: item.serverid,\n              name: item.serverName\n            };\n          });\n          var creativeNames = [];\n          creativeNames.push('全渠道');\n          e.creatives.forEach(function (item) {\n            creativeNames.push(item.creativeName);\n          });\n          var allObject = new Object();\n          allObject.key = '0';\n          allObject.name = '全渠道';\n          creatives.unshift(allObject); //放入Map,creativeid为key\n\n          var creativeMap = new Map();\n          creatives.forEach(function (item, index) {\n            creativeMap.set(item.key, item.name);\n          });\n          var clientNames = [];\n          clientNames.push('所有服');\n          e.clients.forEach(function (item) {\n            clientNames.push(item.serverName);\n          });\n          var object = new Object();\n          object.key = '0';\n          object.name = '所有服';\n          clients.unshift(object);\n          var clientMap = new Map();\n          clients.forEach(function (item, indx) {\n            clientMap.set(item.key, item.name);\n          });\n          _this.arrayCreate = creativeNames;\n          _this.creatives = creatives;\n          _this.creativeMap = creativeMap;\n          _this.arrayClient = clientNames;\n          _this.clients = clients;\n          _this.clientMap = clientMap;\n          /**\n           * -----------------安装付费留存-------------\n           */\n\n          if (installPayReten) {\n            var payInstallRetenArray = [];\n\n            var _loop = function _loop(key) {\n              var payInstallRentenObj = {};\n              payInstallRentenObj.ds = weekChange(installPayReten[key][0].ds);\n              payInstallRentenObj.os = installPayReten[key][0].os;\n              payInstallRentenObj.creative = creativeMap.get(installPayReten[key][0].creative) === undefined ? installPayReten[key][0].creative : creativeMap.get(installPayReten[key][0].creative);\n              payInstallRentenObj.client = clientMap.get(String(installPayReten[key][0].clientid));\n              payInstallRentenObj.payCount = installPayReten[key][0].payInstallCount;\n              payInstallRentenObj.pays = installPayReten[key][0].payCount == 0 ? 0 : (installPayReten[key][0].payInstallCount / installPayReten[key][0].payCount * 100).toFixed(2);\n\n              for (var i = 1; i <= 30; i++) {\n                payInstallRentenObj[i + 'day'] = 0;\n              }\n\n              installPayReten[key].forEach(function (item) {\n                payInstallRentenObj[item.dr + 'day'] = item.payInstallCount == 0 ? 0 : (item.retention / item.payInstallCount * 100).toFixed(2);\n              });\n              payInstallRetenArray.push(payInstallRentenObj);\n            };\n\n            for (var key in installPayReten) {\n              _loop(key);\n            }\n\n            payInstallRetenArray.sort(_this.compare);\n            _this.payInstallRetenTable = payInstallRetenArray;\n          }\n          /**\n           * -------------付费留存---------------\n           */\n\n\n          if (payReten) {\n            var payRetenArray = [];\n\n            var _loop2 = function _loop2(_key) {\n              var payRentenObj = {};\n              payRentenObj.ds = weekChange(payReten[_key][0].ds);\n              payRentenObj.os = payReten[_key][0].os;\n              payRentenObj.creative = creativeMap.get(payReten[_key][0].creative) === undefined ? payReten[_key][0].creative : creativeMap.get(payReten[_key][0].creative);\n              payRentenObj.client = clientMap.get(String(payReten[_key][0].clientid));\n              payRentenObj.payCount = payReten[_key][0].payCount;\n              payRentenObj.pays = (payReten[_key][0].payCount / payReten[_key][0].dauNum * 100).toFixed(2);\n\n              for (var i = 1; i <= 30; i++) {\n                payRentenObj[i + 'day'] = 0;\n              }\n\n              payReten[_key].forEach(function (item) {\n                payRentenObj[item.dr + 'day'] = item.payCount == 0 ? 0 : (item.retention / item.payCount * 100).toFixed(2);\n              });\n\n              payRetenArray.push(payRentenObj);\n            };\n\n            for (var _key in payReten) {\n              _loop2(_key);\n            }\n\n            payRetenArray.sort(_this.compare);\n            _this.payRentenTable = payRetenArray;\n          }\n        }\n      });\n    },\n    creativeOrClientChange: function creativeOrClientChange() {\n      // 还原\n      this.reportRetentionForm.index = \"0\";\n      this.init();\n    },\n    changeCreativeOrClient: function changeCreativeOrClient() {\n      this.init();\n    },\n    clickRetention: function clickRetention(data) {\n      this.retentionTitle = data.ds + '留存趋势';\n      this.surveyOneLine.changeData(this.makeRetentionOne(data));\n    },\n    makeRetentionOne: function makeRetentionOne(data) {\n      var handelRetentionOne = [];\n\n      if (data) {\n        var info1 = new Object();\n        info1.time = 1;\n        info1.value = parseFloat(data.oneRetentionPercentage);\n        handelRetentionOne.push(info1);\n        var info2 = new Object();\n        info2.time = 2;\n        info2.value = parseFloat(data.twoRetentionPercentage);\n        handelRetentionOne.push(info2);\n        var info3 = new Object();\n        info3.time = 3;\n        info3.value = parseFloat(data.threeRetentionPercentage);\n        handelRetentionOne.push(info3);\n        var info4 = new Object();\n        info4.time = 4;\n        info4.value = parseFloat(data.fourRetentionPercentage);\n        handelRetentionOne.push(info4);\n        var info5 = new Object();\n        info5.time = 5;\n        info5.value = parseFloat(data.fiveRetentionPercentage);\n        handelRetentionOne.push(info5);\n        var info6 = new Object();\n        info6.time = 6;\n        info6.value = parseFloat(data.sixRetentionPercentage);\n        handelRetentionOne.push(info6);\n        var info7 = new Object();\n        info7.time = 7;\n        info7.value = parseFloat(data.sevenRetentionPercentage);\n        handelRetentionOne.push(info7);\n        var info8 = new Object();\n        info8.time = 8;\n        info8.value = parseFloat(data.eightRetentionPercentage);\n        handelRetentionOne.push(info8);\n        var info9 = new Object();\n        info9.time = 9;\n        info9.value = parseFloat(data.nineRetentionPercentage);\n        handelRetentionOne.push(info9);\n        var info10 = new Object();\n        info10.time = 10;\n        info10.value = parseFloat(data.tenRetentionPercentage);\n        handelRetentionOne.push(info10);\n        var info11 = new Object();\n        info11.time = 11;\n        info11.value = parseFloat(data.elevenRetentionPercentage);\n        handelRetentionOne.push(info11);\n        var info12 = new Object();\n        info12.time = 12;\n        info12.value = parseFloat(data.twelveRetentionPercentage);\n        handelRetentionOne.push(info12);\n        var info13 = new Object();\n        info13.time = 13;\n        info13.value = parseFloat(data.thirteenRetentionPercentage);\n        handelRetentionOne.push(info13);\n        var info14 = new Object();\n        info14.time = 14;\n        info14.value = parseFloat(data.fourteenRetentionPercentage);\n        handelRetentionOne.push(info14);\n        var info15 = new Object();\n        info15.time = 15;\n        info15.value = parseFloat(data.fifteenRetentionPercentage);\n        handelRetentionOne.push(info15);\n      }\n\n      return handelRetentionOne;\n    },\n    retentionLineChart: function retentionLineChart() {\n      this.retentionLine = new G2.Chart({\n        container: 'retentionLine',\n        forceFit: true,\n        height: 400\n      });\n      this.retentionLine.source(this.retentionAverage);\n      this.retentionLine.coord('rect').transpose().scale(1, -1);\n      this.retentionLine.intervalSymmetric().position('action*pv').shape('pyramid').color('action', ['#0050B3', '#9AFF9A', '#AB82FF', '#53868B', '#D2691E', '#EEA2AD', '#FFFF00']).label('action*pv', function (action, pv) {\n        return action + ' ' + pv;\n      }, {\n        offset: 35,\n        labelLine: {\n          lineWidth: 1,\n          stroke: 'rgba(0, 0, 0, 0.15)'\n        }\n      });\n      this.retentionLine.render();\n    },\n    reportLineChart: function reportLineChart() {\n      /*---------------------单折线图-------------------*/\n      this.surveyOneLine = new G2.Chart({\n        container: 'reportLine',\n        forceFit: true,\n        height: 400\n      });\n      this.surveyOneLine.source(this.handelRetentionOne, {});\n      this.surveyOneLine.scale('value', {\n        min: 0,\n        alias: '留存率'\n      });\n      this.surveyOneLine.scale('time', {\n        // range: [0, 1]\n        tickCount: 8\n      });\n      this.surveyOneLine.tooltip({\n        crosshairs: {\n          type: 'line'\n        }\n      }); // 坐标轴文本旋转\n\n      this.surveyOneLine.axis('time', {\n        label: {\n          rotate: -Math.PI / 2.5,\n          textAlign: 'end',\n          textBaseline: 'middle'\n        }\n      });\n      this.surveyOneLine.line().position('time*value').shape('smooth');\n      this.surveyOneLine.point().position('time*value').size(4).shape('circle').style({\n        stroke: '#fff',\n        lineWidth: 1\n      }).color('l(0) 0:#1E90FF 0.5:#1E90FF 1:#1E90FF');\n      this.surveyOneLine.area().position('time*value').shape('smooth');\n      this.surveyOneLine.render();\n    },\n    saturday: function saturday(data) {\n      if (data) {\n        var retentionAverage = [],\n            oneRetentionPercentageSum = 0,\n            twoRetentionPercentageSum = 0,\n            threeRetentionPercentageSum = 0,\n            fourRetentionPercentageSum = 0,\n            fiveRetentionPercentageSum = 0,\n            sixRetentionPercentageSum = 0,\n            sevenRetentionPercentageSum = 0;\n        data.forEach(function (item, index) {\n          /*做留存的平均处理*/\n          oneRetentionPercentageSum += parseInt(item.oneRetentionPercentage);\n          twoRetentionPercentageSum += parseInt(item.twoRetentionPercentage);\n          threeRetentionPercentageSum += parseInt(item.threeRetentionPercentage);\n          fourRetentionPercentageSum += parseInt(item.fourRetentionPercentage);\n          fiveRetentionPercentageSum += parseInt(item.fiveRetentionPercentage);\n          sixRetentionPercentageSum += parseInt(item.sixRetentionPercentage);\n          sevenRetentionPercentageSum += parseInt(item.sevenRetentionPercentage);\n          var week = new Date(item.ds);\n          var dateweek = week.getDay();\n          var i = 7 - dateweek;\n          var saturdays = [];\n\n          switch (i) {\n            case 7:\n              saturdays = ['oneRetentionPercentage', 'eightRetentionPercentage', 'fifteenRetentionPercentage'];\n              break;\n\n            case 1:\n              saturdays = ['sevenRetentionPercentage', 'fourteenRetentionPercentage'];\n              break;\n\n            case 2:\n              saturdays = ['sixRetentionPercentage', 'thirteenRetentionPercentage'];\n              break;\n\n            case 3:\n              saturdays = ['fiveRetentionPercentage', 'twelveRetentionPercentage'];\n              break;\n\n            case 4:\n              saturdays = ['fourRetentionPercentage', 'elevenRetentionPercentage'];\n              break;\n\n            case 5:\n              saturdays = ['threeRetentionPercentage', 'tenRetentionPercentage'];\n              break;\n\n            case 6:\n              saturdays = ['twoRetentionPercentage', 'nineRetentionPercentage'];\n              break;\n\n            default:\n          }\n\n          ;\n          item.special = saturdays;\n          item.oneSpecial = saturdays[0];\n          item.twoSpecial = saturdays[1];\n          item.ds = weekChange(item.ds);\n        });\n\n        if (this.data == \"7\" || this.data == \"30\") {\n          var retentionAverageD1 = new Object();\n          retentionAverageD1.action = 'D1';\n          retentionAverageD1.pv = Number((oneRetentionPercentageSum / parseInt(this.data)).toFixed(2));\n          retentionAverage.push(retentionAverageD1);\n          var retentionAverageD2 = new Object();\n          retentionAverageD2.action = 'D2';\n          retentionAverageD2.pv = Number((twoRetentionPercentageSum / (parseInt(this.data) - 1)).toFixed(2));\n          retentionAverage.push(retentionAverageD2);\n          var retentionAverageD3 = new Object();\n          retentionAverageD3.action = 'D3';\n          retentionAverageD3.pv = Number((threeRetentionPercentageSum / (parseInt(this.data) - 2)).toFixed(2));\n          retentionAverage.push(retentionAverageD3);\n          var retentionAverageD4 = new Object();\n          retentionAverageD4.action = 'D4';\n          retentionAverageD4.pv = Number((fourRetentionPercentageSum / (parseInt(this.data) - 3)).toFixed(2));\n          retentionAverage.push(retentionAverageD4);\n          var retentionAverageD5 = new Object();\n          retentionAverageD5.action = 'D5';\n          retentionAverageD5.pv = Number((fiveRetentionPercentageSum / (parseInt(this.data) - 4)).toFixed(2));\n          retentionAverage.push(retentionAverageD5);\n          var retentionAverageD6 = new Object();\n          retentionAverageD6.action = 'D6';\n          retentionAverageD6.pv = Number((sixRetentionPercentageSum / (parseInt(this.data) - 5)).toFixed(2));\n          retentionAverage.push(retentionAverageD6);\n          var retentionAverageD7 = new Object();\n          retentionAverageD7.action = 'D7';\n          retentionAverageD7.pv = Number((sevenRetentionPercentageSum / (parseInt(this.data) - 6)).toFixed(2));\n          retentionAverage.push(retentionAverageD7);\n          this.retentionAverage = retentionAverage;\n        }\n\n        return data;\n      }\n    },\n    compare: function compare(obj1, obj2) {\n      var val1 = obj1.ds;\n      var val2 = obj2.ds;\n\n      if (val1 < val2) {\n        return 1;\n      } else if (val1 > val2) {\n        return -1;\n      } else {\n        return 0;\n      }\n    },\n    retentionListClass: function retentionListClass(row, index) {}\n  },\n  mounted: function mounted() {\n    this.reportLineChart();\n    this.retentionLineChart();\n    this.init();\n  }\n};",null]}